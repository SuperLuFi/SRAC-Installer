CSSET --036 ***CITATION*** READS INPUT SECTION 012/ CF-IPTM
C
      SUBROUTINE SSET
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/ABURN/BBURN(30),NSIG1(50),NSIG2(50),NSIG3(50),N1N2R(2,ZDX),
     &  NSIG4(50),NSIG5(50),NSIG6(50),NJM(50),NJMM(50),NJNQ(50),NCH(50),
     &  NZON(ZDX),NXSET(ZDX),NXODR(ZDX),IDXSET(ZDX),NCLASS(ZDX),NDP(ZDX)
     & , XNAME(3,ZDX)
C
      CHARACTER*4 XMN,T1,T2,T3,XNAME
      DATA XMN/'****'/
C
      IX(199) = 0
      IX(34) = 0
      DO 100 M = 1,MMAX
      NZON(M) = 1
      NXSET(M) = 1
      NCLASS(M) = 1
      IDXSET(M) = 1
      NDP(M) = 0
      NXODR(M) = 1
      XNAME(1,M) = XMN
      XNAME(2,M) = XMN
      XNAME(3,M) = XMN
  100 CONTINUE
  101 WRITE(IOUT,1000)
  102 READ(IOIN,1001)N1,N2,N3,N4,N5,N6,N7,N8,T1,T2,T3
      IF (N1) 115,115,103
  103 IF (N2) 104,104,105
  104 N2 = N1
  105 WRITE(IOUT,1002)N1,N2,N3,N4,N5,N6,N7,N8,T1,T2,T3
      IX(34) = IX(34)+1
      N = IX(34)
      N1N2R(1,N) = N1
      N1N2R(2,N) = N2
      DO 114 N = N1,N2
      IF (N3) 107,107,106
  106 CONTINUE
      NZON(N) = N3
  107 IF (N4) 109,109,108
  108 CONTINUE
      NXSET(N) = N4
  109 IF (N5) 111,111,110
  110 CONTINUE
      IDXSET(N) = N5
  111 IF (N6) 113,113,112
  112 CONTINUE
      NCLASS(N) = N6
  113 CONTINUE
      XNAME(1,N) = T1
      XNAME(2,N) = T2
      XNAME(3,N) = T3
      NDP(N) = N7
  114 CONTINUE
      GO TO 102
  115 NSETMX = 0
      NJ=0
      DO 119 M = 1,MMAX
      NN=NZON(M)
      NJ=MAX0(NJ,NN)
      N7 = NXSET(M)
      IF (M-1) 116,116,117
  116 NSETMX = NSETMX+1
      GO TO 119
  117 MM1 = M-1
      DO 118 N = 1,MM1
      NSS = NXSET(N)
      IF (N7-NSS) 118,119,118
  118 CONTINUE
      NSETMX = NSETMX+1
  119 CONTINUE
      IX(168)=NJ
      DO 123 NS = 1,NSETMX
      IF (NS.NE.1) GO TO 121
      N1 = 1000
      DO 120 M = 1,MMAX
      N2 = NXSET(M)
      N1 = MIN0(N1,N2)
  120 CONTINUE
      NXODR(N1) = NS
      GO TO 123
  121 N3 = 1000
      DO 122 M = 1,MMAX
      N2 = NXSET(M)
      IF (N2.LE.N1) GO TO 122
      N3 = MIN0(N2,N3)
  122 CONTINUE
      NXODR(N3) = NS
      N1 = N3
  123 CONTINUE
      DO 124 M=1,MMAX
      IF (NZON(M).LE.1) GO TO 124
      IX(199) = 1
      GO TO 125
  124 CONTINUE
  125 CONTINUE
      RETURN
 1000 FORMAT(1H0/1H0,'DESCRIPTION OF REACTOR ZONES'/
     & 1H0,' ZN TO ZN   SUB-ZNS  SIGMA-SET  ID  CLASS  DPL  NEX'
     & ,'      NAME')
 1001 FORMAT(8I3,3A4)
 1002 FORMAT(1H ,I3,I6,I7,I11,I7,I5,I6,I5,3X,3A4)
      END
