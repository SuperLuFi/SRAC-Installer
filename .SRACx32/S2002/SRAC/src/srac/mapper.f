C             MAPPER              LEVEL=1        DATE=81.11.14
      SUBROUTINE MAPPER ( XRAD,YRAD,IDUM,IDCS,IHX,IHY,IM,IP,JM,JP,IMJM,
     &IBL,IBT,IBR,IBB,IGEOM,L )
C
C     MATERIAL MAP BY BROAD ZONES
C
      COMMON /TW1C/ DD(1),LIM1,IAA(210)
      DIMENSION D(212)
      EQUIVALENCE (D(1),DD(1))
      EQUIVALENCE (D(157),NOUT)
C
      DIMENSION XRAD(IP),YRAD(JP),IDUM(IP),IDCS(IMJM),IHX(IM),IHY(JM)
      DIMENSION IWR(3), IFBND(5), NXYZ01(3), NXYZ02(3)
C
CSASA REAL*8 NXYZ01,NXYZ02
      CHARACTER*8 NXYZ01,NXYZ02
      CHARACTER*4 IWR,ISTR,IFBND
      CHARACTER*4 JBT,JTP,JLF,JRT
C
      DATA IWR,ISTR/'0','1',' ','*'/
      DATA IFBND/'0','1','2','3','4'/
      DATA NXYZ01/'Y     ','Z     ','T     '/
      DATA NXYZ02/'X     ','R     ','R     '/
C
      IF (L.EQ.1) WRITE (NOUT,180)
      IF (L.EQ.2) WRITE (NOUT,190)
      IS=1
      IE=MIN0(18,IM)
      JBT=IFBND(IBB+1)
      JTP=IFBND(IBT+1)
      JLF=IFBND(IBL+1)
      JRT=IFBND(IBR+1)
      IA=0
  100 IF (IE.LT.IM) JRT=IWR(3)
      IMM=IE-IS
      IMP=6*(IMM+1)
      IMPM=IMP-1
      WRITE (NOUT,230)NXYZ01(IGEOM)
      IF (IS.EQ.1) GO TO 110
      WRITE (NOUT,260)
  110 CONTINUE
      WRITE (NOUT,210)YRAD(JP),JLF,(JTP,I=1,IMP)
      DO 140 J=1,JM
      MJ=JP-J
      NXS=(MJ-1)*IM+IA
      NXE=NXS+IE-IA-1
      NXS=NXS+1
      IF (IMM.GT.0) GO TO 120
      WRITE (NOUT,220)JLF,JRT
      WRITE (NOUT,200)MJ,IHY(MJ),JLF,IDCS(NXE+1),JRT
      WRITE (NOUT,220)JLF,JRT
      GO TO 130
  120 WRITE (NOUT,220)JLF,(ISTR,I=1,IMM),JRT
      WRITE (NOUT,200) MJ,IHY(MJ),JLF,(IDCS(I),ISTR,I=NXS,NXE),
     &IDCS(NXE+1),JRT
      WRITE (NOUT,220)JLF,(ISTR,I=1,IMM),JRT
  130 IF (J.EQ.JM) GO TO 140
      WRITE (NOUT,210)YRAD(MJ),JLF,(ISTR,I=1,IMPM),JRT
  140 CONTINUE
      WRITE (NOUT,210)YRAD(1),JLF,(JBT,I=1,IMP)
      K=IE+1
      DO 150 I=IS,K
      IDUM(I)=INT(XRAD(I))
  150 CONTINUE
      WRITE (NOUT,270)NXYZ02(IGEOM),(IDUM(I),I=IS,K)
      DO 160 I=IS,K
      IDUM(I)=IDUM(I)*10000
      IDUM(I)=XRAD(I)*1.0E+4-IDUM(I)
  160 CONTINUE
      WRITE (NOUT,280)(IDUM(I),I=IS,K)
      WRITE (NOUT,240)(IHX(I),I=IS,IE)
      WRITE (NOUT,250)(I,I=IS,IE)
      IF (IE.EQ.IM) GO TO 170
      IA=IE
      IS=IE+1
      IE=MIN0(IE+18,IM)
      JRT=IWR(IBR+1)
      JLF=IWR(3)
      GO TO 100
  170 RETURN
C
C
  180 FORMAT (1H1,53('*'),'REBALANCE MAP',53('*'))
  190 FORMAT (1H1,53('*'),'MATERIAL MAP',54('*'))
  200 FORMAT (4X,I3,2X,I2,2X,A1,20(I4,1X,A1))
  210 FORMAT (1H ,F10.4,2X,A1,20(6A1))
  220 FORMAT (13X,A1,20(5X,A1))
  230 FORMAT (1H0,7X,A1,33X,'MATERIALS BY BROAD ZONE, ORIGIN AT LOWER ',
     &'LEFT.'/'    ROW',3X,'M',31X,'M IS NUMBER OF FINE INTERVALS'
     &/' BROAD ROW(COLUMN).')
  240 FORMAT (1H0,6X,'M',6X,20(I3,3X))
  250 FORMAT ('    COLUMN',4X,20(I3,3X))
  260 FORMAT (1H+,92X,'(CONTINUED)')
  270 FORMAT (7X,A1,1X,19(I5,'.'))
  280 FORMAT (9X,21(2X,I4))
      END
