      SUBROUTINE CLUPH
C
      COMMON / PIJ1C / NX,NY,NTPIN,NAPIN,NCELL,NM,NGR,NGA,NDPIN,
     1              IDIVP,BETM,NX1,NY1,RSETAM,I15,I16,IXP,IYP,IZP,
     2              NDPIN1,NDR,NDA,LL,L0,RO1,DRO,FVOL,RAN,
     3              PIT,RO,BETA,INV,NHEX,SINB,COSB,I36
      COMMON / PIJ2C / IGT,NZ,NR,NRR,NXR,IBOUND,IDRECT,LCOUNT,IEDPIJ,
     1                 IFORM,NTTAB,NUTAB,SZ,IDUM14(26),
     3                 LCMMR,LCNREG,LCIRR,LCIXR,LCMAR,LCMAT,LCVOL,
     4                 LCVOLR,LCVOLX,LCVOLM,LCMATD,AA(950)
      COMMON / PIJC / L00,L01,L02,L03,L04,L05,L06,L07,L08,L09,
     1               L10,L11,L12,L13,L14,L15,L16,L17,L18,L19,L20,L21,
     2               L22,L23,L24,L25,L26,L27,L28,L29,L30,L31,L32,L33,
     3                L34,L35,L36,L37,L38,L39,L40,L41,L42,L43,L44,L45,
     4               DD(55)
      COMMON / MAINC / DDM(63),NOUT1,NOUT2,DDM66(30),MXDIM,DDM97(4),
     *                CASENM(2),TITLE(18),DUM(880)
      COMMON/WORK/A(30000)
C
C     RAN  OUTER LIMIT  FOR ANGULAR INTEGRATION
C     THETA(J,I) LONDITUDE OF PIN ROD J IN RING I (RADIAN)             C
C     DTH(I)= 2*PI/NPIN(I)
C     RX(J) RADII OF RADIAL ZONE J                                     C
C     RDP(K) RADII OF CONCENTRIC DIVISION OF PIN ROD
C     RPP(I) RADII OF RINGS ON WHICH PIN ROD ARE LOCATED
C     NAMER(J) ASSIGNMENT OF RING IN ANNULAR ZONE J
C     NAMEP(2,K,I) ASSIGNMENT OF ANNULAR ZONE OF PIN ROD ZONE
C     NTR(I)       ASSIGNMENT OF RX TRAVERSED BY PIN ROD RING I
C     IDIVP IF =1 AAA RPP TO RX
C           IF =2 DIVID PIN ROD ZONE BY RPP INTO INNER AND OUTER
C     INSERT RPP INTO RX ARRAY
C       PIJ IN FT21  PIJR IN SUMMED UP FORM IN FT22
C 1   RX  BY L01     NX1
C 2   RPP BY L02     NTPIN
C 3   RDP BY L03     NDPIN1*NTPIN
C 4   NPIN  BY L04   0
C 5   THETA BY L05   NTPIN
C 6   TY    BY L06   NY
C 8   D     BY L08   NTTAB
C 9   IM    BY L09   NTTAB
C 10  IP    BY L10   NTTAB
C 11  II    BY L11   NTTAB
C 12  XX    BY L12   NTTAB
C 14  S     BY L14   NR
C 25  XXX   BY L25  NUTAB
C 26  III   BY L26  NUTAB
C 27  V
      L28 = L27 + NZ
C 28  NTR
      L29 = L28 + NX1 + NTPIN
C 29  NAMEP
      L30 = L29 + 2*NDPIN*NTPIN
C 30  NAMER
      L31 = L30 + NX1 + NTPIN
C 31  F
      L32 = L31 + NDPIN1*NTPIN
C 32  NPINPS
      L33 = L32 + NTPIN
C 33  NPINDV
      LAST= L33 + NTPIN
      IF(LAST.LE.MXDIM) GO TO 100
      LAST=LAST-MXDIM
      WRITE(NOUT1,9000) LAST,MXDIM
      STOP
  100 CONTINUE
      WRITE(NOUT1,9010) LAST,MXDIM
 9000 FORMAT(' **DIMENSION OVER.',I10,' FROM ',I10,' IN CLUPH STEP'/)
 9010 FORMAT(' ** STRAGE USED   ',I10,' FROM ',I10,' IN CLUPH STEP'/)
      CALL CLINH(A(L01),A(L02),A(L03),A(L05),A(L06)
     1          ,A(L27),A(L28),A(L29),A(L30),A(L31)
     2          ,A(L32),A(L33))
      CALL VOLPIJ(AA(LCNREG),AA(LCIRR),AA(LCIXR),AA(LCMMR),
     1 A(L27),AA(LCVOL),AA(LCVOLR),AA(LCVOLX),AA(LCVOLM))
C     CALL MAKETC(AA(LCNREG),AA(LCIRR),AA(LCMMR),AA(LCVOL),A(L14)
C    1           ,A(L09),A(L10),A(L11),A(L12),A(L25),A(L26),A(L01)
C    2           ,A(L02),A(L03),A(L28),A(L05),A(L06),A(L29),A(L30)
C    3           ,A(L32),A(L33))
      CALL MAKETX(AA(LCNREG),AA(LCIRR),AA(LCMMR),AA(LCVOL)
     1           ,A(L01),A(L02),A(L03),A(L04),A(L04),A(L05),A(L06)
     2           ,A(L08),A(L09),A(L10),A(L11),A(L12),A(L27),A(L25)
     3           ,A(L26),A(L28),A(L29),A(L30),A(L32),A(L33))
      RETURN
      END
