      SUBROUTINE IPRTXP(HOL,MESHX,MESHP)
      DIMENSION MESHX(NX,1),MESHP(NDPIN,NX1,NY1)
      COMMON / PIJ1C / NX,NY,NTPIN,NAPIN,NCELL,NM,NGR,NGD,NDPIN,
     1                 IDIVP,BETM,NX1,NY1,IDUM(6),NDPIN1
      COMMON /MAINC/ DUM1(63),NOUT1,NOUT2,DUM2(35),CASENM(2),TITLE(18)
C
      CHARACTER*8 AST,BLK,HOL,SUBSTR
CMOD  CHARACTER*124 OUTSTR
C     OUTSTR MAX. LENGTH IS  8 X ( I1+2 - I0 ) + 4
C     THEN OUTSTR LENGHT IS  8 X 16 + 4 = 128 +4  = 132
      CHARACTER*132 OUTSTR
      CHARACTER*3 AST3,BLK3
C
      DATA AST/'********'/,BLK/'  *     '/
      DATA AST3/'***'/,BLK3/'  *'/
C
      I0=1
  100 I1=MIN0(NX,I0+14)
      N8=8*(I1-I0)
      LINE=60
      DO 200 J=1,NY1
      IF(LINE.LT.60) GO TO 140
      WRITE(NOUT2,8000) CASENM,TITLE,HOL
 8000 FORMAT(1H1///10X,2A4,'**',18A4,5H**** ,A8,12H NUMBER **** )
 8001 FORMAT(5X,I2,15I8)
C8002 FORMAT(4X,15A8)
 8002 FORMAT(4X,16A8)
 8003 FORMAT(1H(,I3,1H))
 8004 FORMAT(2H <,I3,3H> *)
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
      WRITE(NOUT2,8001) (I-1,I=I0,I1+1)
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
      LINE=10
  140 CONTINUE
      DO 180 JJ=1,NDPIN
      IF(JJ.EQ.1) THEN
      WRITE(OUTSTR(1:4),'(I3,1H )') J-1
      DO 150 N=I0,I1
  150 OUTSTR(1:8*(N-I0)+12)=OUTSTR(1:8*(N-I0)+4)//AST
      OUTSTR(1:8*(I1-I0)+15)=OUTSTR(1:8*(I1-I0)+12)//AST3
                  ELSE
      OUTSTR(1:4)='    '
      DO 160 N=I0,I1
  160 OUTSTR(1:8*(N-I0)+12)=OUTSTR(1:8*(N-I0)+4)//BLK
      OUTSTR(1:8*(I1-I0)+15)=OUTSTR(1:8*(I1-I0)+12)//BLK3
      ENDIF
C **  SCAN IF PIN ROD LOCATED
      DO 170 I=I0,I1+1
      IF(MESHP(JJ,I,J).NE.0) THEN
      WRITE(SUBSTR,8003) MESHP(JJ,I,J)
      OUTSTR(8*(I-I0)+5:8*(I-I0)+9)=SUBSTR(1:5)
      ENDIF
  170 CONTINUE
      WRITE(NOUT2,'(A)') OUTSTR(1:8*(I1-I0)+17)
  180 CONTINUE
      LINE=LINE+NDPIN
      IF(J.EQ.NY1) GO TO 200
C *** MODERATOR REGION
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
      WRITE(OUTSTR,8002) (BLK,I=I0,I1+1)
      DO 190 I=I0,I1
      WRITE(SUBSTR,8004) MESHX(I,J)
      OUTSTR(8*(I-I0)+8:8*(I-I0)+15)=SUBSTR
  190 CONTINUE
      WRITE(NOUT2,'(A)') OUTSTR(1:8*(I1-I0)+15)
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
C     LINE=LINE+3
  200 CONTINUE
      IF(I1.GE.NX) RETURN
      I0=I1+1
      GO TO 100
      END
