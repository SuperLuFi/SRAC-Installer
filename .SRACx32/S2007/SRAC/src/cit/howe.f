CHOWE --092 ***CITATION*** GET TYPE OF EIGNVALUE CALC./ CF-CALR
C
      SUBROUTINE HOWE(NCY,IND1,IND2,IHW,ITX,ITM)
C
C     INPUT - IND1.EQ.0 = INITIAL COND.   IND1.GT.0 = DURING CYCLE
C     OUTPUT - IND2.EQ.0 = NO INITIAL COND.   IND2.GT.0 = YES
C     OUTPUT - IHW = TYPE EIGN.   ITX = NO. ITER.   ITM = TIME
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/AFLUX/BFLUX(30),KXMN8,NIT,NIIT,NIIIT,JXP1,KSCT1,KSCT2,
     & ISTART,IEP, VRGP1,VRGP2,VRGP3,VRG1,VRG2,VRGK1,VRGK2,XABS,PROD,
     & XLEK,RMX,RMN,XKEF1,XKEF2,XKEF3,EXFC1,EXFC2,EXFC3, NI3,IEXTR,
     & IRECV,VRGABS,LO3,LO4,XLAMDA,EPI1,EPI2, BETTA,SUMXI,IX25,IX28,I,J,
     &  KB,K,ITMAX,ITIME, BET(MSX),DEL(MSX)
C
      DO 100 I = 44,49
      IX(I) = 0
  100 CONTINUE
      IX(23) = 0
      IX(128) = 0
      IF (NGC(11).LT.0) GO TO 101
      IX(49) = NGC(11)
      GO TO 102
  101 IX(44) = IABS(NGC(11))
  102 IF (IND1.GT.0) GO TO 107
      DO 103 I = 1,24
      IX(I+100) = IEDG(I)
  103 CONTINUE
      IF (IX(3).EQ.NGC(12)) IX(23) = 1
      EPI1 = EPI(1)
      IF (NGC(1).EQ.0) GO TO 110
      IF (NDPL(1).EQ.0) GO TO 110
      IF (NCY.GT.1) GO TO 105
      IF (NDPL(7).NE.0) GO TO 104
      IND2 = 0
      GO TO 136
  104 IND2 = 1
      IHW = NDPL(7)
      ITX = ITMX(1)
      ITM = ITMX(19)
      IF (NDPL(7).GT.0) GO TO 111
      GO TO 136
  105 IF (NDPL(8).NE.0) GO TO 106
      IND2 = 0
      GO TO 136
  106 IND2 = 1
      IHW = NDPL(8)
      ITX = ITMX(1)
      ITM = ITMX(19)
      IF (NDPL(8).GT.0) GO TO 111
      GO TO 136
  107 DO 108 I = 1,24
      IX(I+100) = IXPUT(I)
  108 CONTINUE
      EPI1 = EPI(4)
      IF (NCY.GT.1) GO TO 109
      IHW = NDPL(9)
      ITX = ITMX(2)
      ITM = ITMX(20)
      IF (NDPL(9).GT.0) GO TO 111
      GO TO 136
  109 IHW = NDPL(10)
      ITX = ITMX(2)
      ITM = ITMX(20)
      IF (NDPL(10).GT.0) GO TO 111
      GO TO 136
  110 IND2 = 1
      IHW = NGC(10)
      ITX = ITMX(1)
      ITM = ITMX(19)
      IF (NGC(10).LE.0) GO TO 136
  111 GO TO 118
  112 NOW = 1
      GO TO 117
  113 NOW = 2
      GO TO 117
  114 NOW = 3
      GO TO 117
  115 NOW = 4
      GO TO 117
  116 NOW = 5
  117 WRITE(IOUT,1000) NOW
      WRITE(IOUT,2000)
      STOP
  118 IO10 = IX(77)
  119 READ(IO10,END=112) N1,N2,N3
      IF (N1.EQ.28) GO TO 121
      IF (N2.EQ.0) GO TO 119
      DO 120 I = 1,N2
      READ(IO10)
  120 CONTINUE
      GO TO 119
  121 IF (N3.EQ.0) GO TO 113
      DO 124 N=1,N3
      READ(IO10) (NSRH(I),I=1,24),X,(XSRH1(I),I=2,6)
      IF (NSRH(1).EQ.IHW) GO TO 125
      IF (NSRH(2).EQ.3) GO TO 123
      IF (NSRH(10).NE.(-1)) GO TO 124
      READ(IO10) NXZ
      READ(IO10)
      DO 122 M=1,NXZ
      READ(IO10)
  122 CONTINUE
      GO TO 124
  123 CONTINUE
      READ(IO10) NXJ,NXI,NXKB
      IF (NXJ.GT.0) READ(IO10)
      IF (NXI.GT.0) READ(IO10)
      IF (NXKB.GT.0) READ(IO10)
  124 CONTINUE
      GO TO 114
  125 IHW = NSRH(2)
      IF (X) 126,115,127
  126 XSRH1(1) = ABS(X)*XKEF1
      GO TO 128
  127 XSRH1(1) = X
  128 IF (XSRH1(1).LT.0.1.OR.XSRH1(1).GT.3.0) GO TO 116
      SPARE(50) = XSRH1(1)
      IF (NSRH(2).EQ.3) GO TO 130
      IF (NSRH(2).EQ.1.AND.NSRH(10).EQ.(-1)) IX(128) = 1
      IF (NSRH(10).NE.(-1)) GO TO 134
      IO18 = IX(85)
      REWIND IO18
      READ(IO10) (NXTR1(I),I=1,5),(XTR1(I),I=1,5)
      WRITE(IO18) (NXTR1(I),I=1,5),(XTR1(I),I=1,5)
      NXZ = NXTR1(1)
      READ(IO10) (NXTR1(I),I=1,NXZ)
      WRITE(IO18) (NXTR1(I),I=1,NXZ)
      DO 129 M=1,NXZ
      READ(IO10) (XTR1(NN),NN=1,NMAX)
      WRITE(IO18) (XTR1(NN),NN=1,NMAX)
  129 CONTINUE
      REWIND IO18
      GO TO 134
  130 CONTINUE
      IO18 = IX(85)
      REWIND IO18
      READ(IO10) (NXTR1(I),I=1,7),(XTR1(I),I=1,5)
      WRITE(IO18) (NXTR1(I),I=1,7),(XTR1(I),I=1,5)
      NXJ = NXTR1(1)
      NXI = NXTR1(2)
      NXKB = NXTR1(3)
      IF (NXJ.LE.0) GO TO 131
      READ(IO10) (XTR1(I),I=1,NXJ)
      WRITE(IO18) (XTR1(I),I=1,NXJ)
  131 IF (NXI.LE.0) GO TO 132
      READ(IO10) (XTR1(I),I=1,NXI)
      WRITE(IO18) (XTR1(I),I=1,NXI)
  132 IF (NXKB.LE.0) GO TO 133
      READ(IO10) (XTR1(I),I=1,NXKB)
      WRITE(IO18) (XTR1(I),I=1,NXKB)
  133 CONTINUE
      REWIND IO18
  134 CONTINUE
      REWIND IO10
      DO 135 I = 1,6
      IX(I+43) = NSRH(I+3)
  135 CONTINUE
  136 CONTINUE
C     NUAC(23) = MAX0(NUAC(23),1)
      T1 = IMAX*JMAX
      T2 = T1**0.25*1.5
      IA = T2
      I = IA+IX(29)/2
      IX(35) = NUAC(22)
      IF (NUAC(22).EQ.0) IX(35) = I
      IF ((IHW.LT.0).OR.(IHW.EQ.1)) NUAC(3) = 0
      RETURN
 1000 FORMAT(1H0,'ERROR STOP 21-',I3)
 2000 FORMAT(1H ,'CRITICALITY SEARCH SPECIFICATIONS INCORRECT AT THE T',
     &      'IME OF CALCULATION:'/
     &      ' -1 SECTION 028 NOT SUPPLIED'/
     &      ' -2 IDENTIFICATION NUMBER IN FIRST SET OF DATA OF SECTION',
     &      ' 028 IS 0.',
     &      ' -3 IDENTIFICATION NUMBER OF INPUT DATA SETS (SECTION 023',
     &      ') DOSE NOT CORRESPONDED WITH NGC10 (SECTION 001) OR NDPL7',
     &      ',NDPL8,NDPL9 OR NDPL10 (SECTION 002).',
     &      ' -4 SEARCH K-EFF ZERO'               ,
     &      ' -5 SEARCH K-EFF OUTSIDE OF THE RANGE 0.1 < K-EFF < 3.0.')
      END
