      SUBROUTINE REACI1(MREC  ,IGMAX ,IMESHT,IMESH1,IMESH2,
     2                  IMESH3,MTNAM1,IREAC1,NMESH1,MTNAM2,
     3                  IREAC2,NMESH2,FG    ,NREC  ,MPOSI ,
     4                  LU235 ,LU238 ,FGS   ,MESH  ,LMESH2,
     5                  NMESH3,IA    ,LMESH3,LAST  ,LFINAM,
     5                  ICVRAT,IRALIM,NOUT2 ,IOPT1 ,IOPT2 ,
     6                  IOPT3 ,IOPT4                       )
C
C    REACTION RATE INPUT ROUTINE-1
C
      DIMENSION MTNAM1(2,IOPT1),MTNAM2(2,IOPT2),
     1          IREAC1(IOPT1),IREAC2(IOPT2),NMESH1(IOPT1),
     2          NMESH2(IOPT2),NMESH3(IOPT3),MESH(3,1),
     3          IRN(6),FG(IGMAX,IOPT2),FGS(IGMAX,IOPT3),
     4          NREC(IOPT3),LU235(IOPT3),LU238(IOPT3),MPOSI(MREC),
     5          IA(IRALIM)
C
      IMESH1 = 1
C
C     NON FILTERED DETECTOR
C
      IF (IOPT1.EQ.0) GO TO 1000
      WRITE(NOUT2,6200)
      DO 100 I=1,IOPT1
          CALL REAM(MTNAM1(1,I),IRN,DUM,2,2,0)
          IREAC1(I)=IRN(1)
          NMESH1(I)=IRN(2)
          WRITE(NOUT2,6210) (MTNAM1(J,I),J=1,2),IREAC1(I),NMESH1(I)
          CALL REAM(DUM,MESH(1,IMESH1),DUM,0,IRN(2)*3,0)
          WRITE(NOUT2,6220) (MESH(1,J),J=IMESH1,IMESH1+IRN(2)-1)
          WRITE(NOUT2,6230) (MESH(2,J),J=IMESH1,IMESH1+IRN(2)-1)
          WRITE(NOUT2,6240) (MESH(3,J),J=IMESH1,IMESH1+IRN(2)-1)
          IMESH1   =IMESH1 +IRN(2)
  100 CONTINUE
C
 1000 CONTINUE
      LOC    = IMESH1
      IMESH1 = IMESH1 - 1
      LMESH2 = LAST + IMESH1*3
      IF(IOPT2.EQ.0) GO TO 2000
C
C     FILTERED DETECTOR
C
      WRITE(NOUT2,6300)
      DO 200 I=1,IOPT2
          CALL REAM(MTNAM2(1,I),IRN,DUM,2,2,0)
          IREAC2(I)=IRN(1)
          NMESH2(I)=IRN(2)
          WRITE(NOUT2,6210) (MTNAM2(J,I),J=1,2),IREAC2(I),NMESH2(I)
          CALL REAM(DUM,MESH(1,LOC),DUM,0,IRN(2)*3,0)
          WRITE(NOUT2,6220) (MESH(1,J),J=LOC,LOC+IRN(2)-1)
          WRITE(NOUT2,6230) (MESH(2,J),J=LOC,LOC+IRN(2)-1)
          WRITE(NOUT2,6240) (MESH(3,J),J=LOC,LOC+IRN(2)-1)
          CALL REAM(DUM,DUM,FG(1,I),0,0,IGMAX)
          WRITE(NOUT2,6310) (FG(J,I),J=1,IGMAX)
          LOC=LOC+IRN(2)
  200 CONTINUE
C
 2000 CONTINUE
      IMESH2       = LOC - IMESH1 - 1
      LMESH3       = LMESH2 + IMESH2*3
      IF(IOPT3.EQ.0) GO TO 3000
C
C     INTEGRATED PARAMETER
C
      WRITE(NOUT2,6400)
CDEL
C     WRITE(NOUT2,6401) MREC
C     CALL REAM(DUM,NREC(1),DUM,0,MREC,0)
C     WRITE(NOUT2,6402) (NREC(J),J=1,MREC)
CEND
      WRITE(NOUT2,6403)
      DO 300 I=1,IOPT3
          CALL REAM(DUM,IRN,FGS(1,I),0,6,IGMAX)
          MPOSI(I)   =IRN(1)
          LU235(I)   =IRN(2)
          LU238(I)   =IRN(3)
          MESH(1,LOC)=IRN(4)
          MESH(2,LOC)=IRN(5)
          MESH(3,LOC)=IRN(6)
          NMESH3(I)  =1
          WRITE(NOUT2,6410) MPOSI(I),LU235(I),LU238(I),(MESH(J,LOC),
     1                      J=1,3),(FGS(J,I),J=1,IGMAX)
          LOC=LOC+1
  300 CONTINUE
 3000 CONTINUE
      IMESH3 =  IOPT3
      IMESHT = LOC - 1
      LAST   = LMESH3 + IMESH3*3
CDEL  IOPT4 = 0
      IF (ICVRAT.EQ.0) RETURN
C
C
C
      LFINAM = LAST
      LOC = LFINAM
      WRITE(NOUT2,6420)
CDELETE
C 400 CONTINUE
C     CALL REAM(IA(LOC),IA(LOC+4),DUM,2,1,0)
C     IF (IA(LOC+4).EQ.0) GO TO 500
C     NREG = IA(LOC+4)
C     IOPT4 = IOPT4 + 1
C     CALL REAM(IA(LOC+2),IA(LOC+5),DUM,2,NREG,0)
C     WRITE(NOUT2,6430) (IA(LOC-1+J),J=1,4),(IA(LOC+4+J),J=1,NREG)
C     LOC = LOC + 5 + NREG
C     IF (LOC.GT.IRALIM) THEN
C        WRITE(NOUT2,6600) IRALIM,LOC
C        STOP
C     ENDIF
C     GO TO 400
C 500 CONTINUE
CEND
C***** READ BLOCK5.1
      CALL REAM(DUM,NREG,DUM,0,1,0)
      LMAX    = LOC + 2*NREG + IOPT4*2
      IF (LMAX.GT.IRALIM) THEN
                          WRITE(NOUT2,6600) IRALIM,LMAX
                          STOP
                          ENDIF
C
      IA(LOC) = NREG
      LOCMTN  = LOC
      LOC     = LOC + 1
C***** READ BLOCK5.2 NREG TIMES MTNAME
      DO 500 LOP = 1 , NREG
      CALL REAM(IA(LOC),DUM  ,DUM ,2 ,  0,0)
      LOC     = LOC + 2
  500 CONTINUE
C
      WRITE(NOUT2,6430) NREG
      DO 505 I = 1 , NREG
      ISW2     = LOCMTN + 2*I
      ISW1     = ISW2   - 1
      WRITE(NOUT2,6435) I,IA(ISW1),IA(ISW2)
  505 CONTINUE
      WRITE(NOUT2,6440)
C
      DO 510 LOP = 1 , IOPT4
C***** READ BLOCK5.3
      CALL REAM(DUM,IA(LOC),DUM,0 , 2,0)
      WRITE(NOUT2,6450) IA(LOC),IA(LOC+1)
      LOC  = LOC + 2
  510 CONTINUE
      WRITE(NOUT2,6460)
CEND
      LAST = LOC - 1
      RETURN
C
 6200 FORMAT(1H0/11X,'--- NON FILTERED DETECTOR REACTION RATE ---')
 6210 FORMAT(1H0,10X,'MEMBER NAME : ',2A4,' , REACTION :',I2,
     1               ' , MESH POINTS :',I4/)
 6220 FORMAT(1H ,10X,'X-MESH',4X,22I5/(21X,22I5))
 6230 FORMAT(1H ,10X,'Y-MESH',4X,22I5/(21X,22I5))
 6240 FORMAT(1H ,10X,'Z-MESH',4X,22I5/(21X,22I5))
 6300 FORMAT(1H0/11X,'--- FILTERED DETECTOR REACTION RATE ---')
 6310 FORMAT(1H0,10X,'PENETRATING RATE  ',1P8E13.5/(29X,1P8E13.5))
 6400 FORMAT(1H0/11X,'--- INTEGRATED PARAMETER OF FISSILE NUCLIDE ---')
 6401 FORMAT(1H0,10X,'NUMBER OF RECORDS OF MICRO CROSS SECTION :',I3)
 6402 FORMAT(1H0,10X,'NUMBER OF MATERIALS ',20I5/(31X,20I5))
 6403 FORMAT(1H0/11X,'MATERIAL  U-235  U-238  X-MESH Y-MESH Z-MESH  ',
     2               'EPITHERMAL INDICATOR')
 6410 FORMAT(1H0,11X,I4,1X,2(4X,I3),1X,3(4X,I3),2X,1P6E13.5/
     1       (55X,1P6E13.5))
 6420 FORMAT(1H0/11X,'--- CONVERSION RATIO CALCULATION DATA ---')
CMOD
C6430 FORMAT(1H0,12X,'FISSILE MEMBER NAME === ',2A4,2X,
C    1               'FERTILE MEMBER NAME === ',2A4/
C    2           13X,'ZONE NUMBER=== ',20I5/
 6430 FORMAT(1H0,12X,'NO OF ZONES         === ',I5/)
 6435 FORMAT(1H ,12X,I3,'-TH X-SECTION MATERIAL NAME IS ',2A4 )
 6440 FORMAT(1H0,12X,'NUMERATOR REACTION ID / DENOMINATOR REACTION ID',
     1      /1H ,12X,'-----------------------------------------------')
 6450 FORMAT(1H ,12X,I12,10X,'/',I12)
 6460 FORMAT(1H ,12X,'-----------------------------------------------',
     1      /1H ,15X,'REACTION ID (-1/0/1/2/3:1.0/FIS/CAP/ABS/PROD)'/)
CEND
 6500 FORMAT(1H0,10X,'*REACTION DATA STEP* (REACIN)'/11X,
     1               'ERROR IOPT IS NEGATIVE')
 6600 FORMAT(1H0,10X,'*REACTION DATA STEP* (REACIN)'/11X,
     1               '/REACC/ LIMIT EXCEED'/11X,
     2               'ALLOCATED',I6,' WORDS,BUT NEEDS',I6,' WORDS')
      END
