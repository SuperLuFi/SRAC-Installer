CEIGN --076 ***CITATION*** EIGENVALUE CALC. CONTROL/ CF-CALR
C
      SUBROUTINE EIGN (A,P2,P2E,NTITE,IDX,JDX,KDX,JIDX,KBDX,IX3738)
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      REAL*8 P2
C
      COMMON/SRACIT/ID2,IXKI,IDELAY,IXYZ(ZNEX)
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/AFLUX/BFLUX(30),KXMN8,NIT,NIIT,NIIIT,JXP1,KSCT1,KSCT2,
     & ISTART,IEP, VRGP1,VRGP2,VRGP3,VRG1,VRG2,VRGK1,VRGK2,XABS,PROD,
     & XLEK,RMX,RMN,XKEF1,XKEF2,XKEF3,EXFC1,EXFC2,EXFC3, NI3,IEXTR,
     & IRECV,VRGABS,LO3,LO4,XLAMDA,EPI1,EPI2, BETTA,SUMXI,IX25,IX28,I,J,
     &  KB,K,ITMAX,ITIME, BET(MSX),DEL(MSX)
      COMMON/AKADD/KAY(1),K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11, K12,K13,
     & K131,K14,K15,K16,K17,K18,K19,K20,K21,K22,K23,K24, K25,K26,K27,
     & K28,K29,K30,K31,K32,K33,K34,K35,K36,K37, K38,K39,K40,K41,K42,K43,
     &  K44,K45,K46,K47,K48,K49, K50,K51,K52,K53,K54,K55,K56,K57,K58,
     & K59, K60,K61,K62, K63,K64,K65,K66,K67,K68,K69,K70,K71,K72,K73,
     & K74,K75, K76,K77,K78,K79,K80,K81,K82,K83,K84,K85,K86,K87, K88,
     & K89,K90, K91,K92,K93,K94,K95,K96,K97,K98, K99,K100,NDATA,KNRGN,
     & KNCOMP, KPVOL,KRVOL,MEMVRY, MEMX
      COMMON/AVDLM/IVDLM(1),IVX,JVX,KBVX,KVX,LVX,MVX,NVX,IVXP1,JVXP1,
     & KBVXP1,NSETVX,NVO,IVO,IVZ,KVZ,NCRP,NSPA,N3DDIM,NBLOCK, JIVX,
     & JIP1VX,JP1IXZ,IOVX,IOVZ
C
      DIMENSION A(1), P2(JDX,IDX,KDX), P2E(JIDX,KBDX,KDX)
C
CI EIGEN VALUE CALCULATION BYPASS FOR SPECIAL CASE
      IF (NGC(13).LT.0) GO TO 103
      IX(40) = 0
      JIPROD = JMAX*IMAX
      IF (IX(24).EQ.0) GO TO 102
      DO 100 K= 1,KMAX
      READ(IOFLX)
  100 CONTINUE
      READ(IOFLX)
      IX(5) = 0
      XLAMDA = SPARE(27)
      IF (NUAC(5).GT.10) GO TO 101
      IF (IX(71).GT.0) GO TO 106
      GO TO 107
  101 IF (IX(71).GT.0) GO TO 111
      GO TO 112
  102 CONTINUE
      IX(17) = IX(5)
      INDO = 0
C**** IN BIGS, ARRAY F1 WILL USE THE CORE RESERVED FOR ARRAY SCAC
  103 CONTINUE
      KBVSIG = K17 + NVX*MVX
      KDXII  = KBVSIG + KVX*IDELAY*MVX
      KBLSIG = KDXII + KVX*IDELAY*MVX
      CALL BIGS (A(K23),A(K17),A(K1),A(K2),A(K3),A(K4),A(K5),A(K6),
     & A(K14),A(K8),A(K7),INDO,A(K9),KVX,MVX,NVX,NSETVX,A(K50),A(K16),
     & A(K18),A(K13),NVO,
     & A(KBVSIG),A(KDXII),A(KBLSIG))
CI EIGEN VALUE CALCULATION BYPASS FOR SPECIAL CASE
      IF (NGC(13).LT.0) RETURN
  104 IF (NUAC(5)-10) 105,105,110
  105 CONTINUE
  106 CONTINUE
      CALL CNST (A(KNRGN),A(K23),A(K65),A(K64),A(K15),A(K14),A(K63),
     & A(KNCOMP),A(KPVOL),A(K50),A(K51),IVX,JVX,KVX,LVX,MVX,IVXP1,JVXP1,
     &  IVZ,KVZ,IOVX,IOVZ,A,MEMVRY,A(K64),IX3738)
      IF (IX(172).GT.0) GO TO 108
      IF (IX(71).GT.0) GO TO 107
      IF (IX(39).NE.0) GO TO 107
      IF (IX(22).NE.0) GO TO 107
      IF (NTITE.NE.0) GO TO 107
      IF ((NGC(2).NE.0).AND.(NUAC(2).EQ.0)) GO TO 109
      IF ((NGC(2).NE.0).AND.(NUAC(2).NE.0)) GO TO 107
      IF (IX(2).GT.1) GO TO 109
  107 CONTINUE
      IF (IX(5).GE.2.AND.IX(73).GT.1) GO TO 108
      CALL INFX (P2,A(KNRGN),A(KNCOMP),A(K50),IVX,JVX,KVX,LVX)
  108 CONTINUE
      IX(39) = 0
      IX(22) = 0
  109 CONTINUE
      CALL FLUX (A(KNRGN),A(K29),A(K21),A(K36),A(K37),A(K38),A(K39),
     & A(K23),A(K17),A(K41),A(K24),A(K65),A(K64), A(K19),A(K20),A(K63),
     & A(KNCOMP),A(K15),A(K1),A(K2),A(K3),A(K4),A(K5),A(K6),A(K14),
     & A(K8),A(K7),A(KPVOL),A(K9), A(K50),A(K51),A(K16),A(K52), A(K49),
     & IVX,JVX, KVX,LVX,MVX,NVX,IVXP1,JVXP1,IVZ,KVZ, NSETVX,IOVX,IOVZ,A,
     &  MEMVRY,A(K64),IX3738,A(K62),A(K45),NCRP,NSPA, A(K18),A(K13),NVO)
      GO TO 115
  110 CONTINUE
  111 CONTINUE
      CALL KNST (A(KNRGN),A(K23),A(K65),A(K64),A(K66),A(K15),A(K14),
     & A(K63),A(KNCOMP),A(KPVOL),A(K50),A(K51),IVX,JVX,KBVX,KVX,LVX,MVX,
     &  IVXP1,JVXP1,KBVXP1,IVZ,KVZ,JIVX,JIP1VX,JP1IXZ,IOVX,IOVZ,A,
     & MEMVRY,A(K64),IX3738)
      IF (IX(172).GT.0) GO TO 113
      IF (IX(71).GT.0) GO TO 112
      IF (IX(39).NE.0) GO TO 112
      IF (IX(22).NE.0) GO TO 112
      IF (NTITE.NE.0) GO TO 112
      IF ((NGC(2).NE.0).AND.(NUAC(2).EQ.0)) GO TO 114
      IF ((NGC(2).NE.0).AND.(NUAC(2).NE.0)) GO TO 112
      IF (IX(2).GT.1) GO TO 114
  112 CONTINUE
      IF (IX(5).GE.2.AND.IX(73).GT.1) GO TO 113
      CALL KNFX (P2E,A(KNRGN),A(KNCOMP),A(K50),IVX,JVX,KBVX,KVX,LVX,
     & JIVX)
  113 CONTINUE
      IX(39) = 0
      IX(22) = 0
  114 CONTINUE
      CALL KLUX (A(KNRGN),A(K29),A(K21),A(K36),A(K37),A(K38),A(K39),
     & A(K23),A(K17),A(K41),A(K24),A(K65),A(K64),A(K66),A(K19),A(K20),
     & A(K63), A(KNCOMP),A(K15),A(K1),A(K2),A(K3),A(K4),A(K5),A(K6),
     & A(K14), A(K8),A(K7),A(KPVOL),A(K9), A(K50),A(K51),A(K16),A(K52),
     & A(K49),IVX,JVX,KBVX,KVX,LVX,MVX,NVX,IVXP1,JVXP1,KBVXP1,IVZ,KVZ,
     & NSETVX,JIVX,JIP1VX,JP1IXZ,IOVX,IOVZ,A,MEMVRY,A(K64),IX3738,A(K62)
     &  , A(K45),NCRP,NSPA,A(K18),A(K13),NVO)
  115 CONTINUE
      IF (IX(5).LT.2) GO TO 122
      IF (IX(5).GT.2) GO TO 117
      CALL DISH(A(K1),A(K2),A(K17),A(K9),A(K4),KVX,MVX,NVX,NSETVX)
      IF (IX(199).EQ.0) GO TO 116
      CALL SSZU(A(K17),A(K18),A(K9),A(K19),MVX,NVX,NSETVX,NVO)
  116 CONTINUE
      GO TO 118
  117 CONTINUE
      CALL CRSH(A(KRVOL),A(KPVOL),LVX)
  118 CONTINUE
      IF (IX(73).EQ.2) GO TO 122
      IF (IX(75).EQ.1.OR.IX(70).NE.0) GO TO 119
      GO TO 120
  119 IF (IX(5).EQ.2) GO TO 123
      GO TO 124
  120 IF (NUAC(5).GT.10) GO TO 121
      CALL DASH(P2,A(K19),JVX,IVX,KVX)
      GO TO 122
  121 CALL KASH(P2E,A(K19),JVX,IVX,KBVX,KVX,JIVX)
  122 CONTINUE
      IF (IX(5).EQ.1) GO TO 123
      IF (IX(5).EQ.(-1)) GO TO 123
      IF (IX(5).EQ.(-2)) GO TO 123
      GO TO 124
  123 CALL FASP(A(K1),A(K14),A(K17),A(K9),A(KPVOL),A(KNCOMP),A(K21),
     & XLAMDA,KVX,NVX,MVX,LVX,NSETVX)
  124 CONTINUE
      IF (IX(24).GT.0) GO TO 129
      IF (IX(5).GE.2.AND.IX(70).NE.0) GO TO 125
      IF (IX(5).GE.2.AND.IX(75).LE.0) GO TO 134
  125 CONTINUE
      IF (NUAC(3).GT.0) GO TO 126
      CALL NMBL(A(K21),A(K38),P2,A(KRVOL),A(KNCOMP),A(K14),P2E,A(K52),
     & IVX,JVX,KBVX,KVX,LVX,MVX,JIVX,A(K36),A(K39))
      IF (NGC(8).GT.0) CALL DODA (A(K41),A(K41),P2,P2E,A(KNRGN),A(KNRGN)
     &  , A(K16),XKEF1,JVX,IVX,KBVX,KVX,LVX,JIVX,A(K14),A(KPVOL),
     & A(KNCOMP), MVX,A(K19),A(K19))
  126 CONTINUE
      DO 128 K= 1,KMAX
      IF (NUAC(5).LE.10) GO TO 127
      WRITE(IOFLX) ((P2E(N1 ,KB,K),N1=1,JIPROD),KB=1,KBMAX)
      GO TO 128
  127 WRITE(IOFLX) ((P2(J,I,K),J=1,JMAX),I=1,IMAX)
  128 CONTINUE
      WRITE(IOFLX)XLAMDA,BETTA,VRGK2
      END FILE IOFLX
      REWIND IOFLX
      GO TO 134
  129 CONTINUE
      DO 131 K=1,KMAX
      IF (NUAC(5).LE.10) GO TO 130
      WRITE(IOFLX) ((P2E(N1 ,KB,K),N1=1,JIPROD),KB=1,KBMAX)
      GO TO 131
  130 WRITE(IOFLX) ((P2(J,I,K),J=1,JMAX),I=1,IMAX)
  131 CONTINUE
      END FILE IOFLX
      REWIND IOFLX
      DO 133 K= 1,KMAX
      IF (NUAC(5).LE.10) GO TO 132
      READ(IOFLX) ((P2E(N1 ,KB,K),N1=1,JIPROD),KB=1,KBMAX)
      GO TO 133
  132 READ(IOFLX) ((P2(J,I,K),J=1,JMAX),I=1,IMAX)
  133 CONTINUE
      READ(IOFLX)XLAMDA,BETTA,VRGK2
      REWIND IOFLX
  134 CONTINUE
      RETURN
      END
