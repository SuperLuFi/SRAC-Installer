C             WWRITE              LEVEL=1        DATE=81.11.14
      SUBROUTINE WWRITE (IOP,IF,ARRAY,IM,JM,KM,H1,H2,H3,H4)
C
C     PRINT ARRAYS
C
C     IOP=1/2/3/4/5   1D/2D/3D/FLUX OR Q/PARTIAL 2D    IF=1/2  INT/FLOAT
C
      COMMON /TW1C/ DD(1),LIM1,IAA(210)
      DIMENSION D(212)
      EQUIVALENCE (D(1),DD(1))
      EQUIVALENCE (D(157),NOUT)
C
      DIMENSION ARRAY(IM,JM,KM)
      DIMENSION HH1(1), IHH1(2)
C
      EQUIVALENCE (IHH1(1),HH1(1))
C
CSASA REAL*8 H1,H2,H3,H4,HH1
      REAL*8             HH1
CMSASA
C     CHARACTER*8 H1,H2,H3,H4
      CHARACTER*6 H1,H2,H3,H4
C
CSASA IF ((IOP.EQ.4).OR.(IOP.EQ.5)) IH1 = H1
      IF ((IOP.EQ.4).OR.(IOP.EQ.5)) IH1 = CUT4(H1)
C
C     CHECK ARRAY FOR EQUAL ENTRIES
      CALL ECHECK (ARRAY,IM*JM*KM,IEQ)
      IF (IEQ.EQ.0) GO TO 100
C
C     ALL ENTRIES ARE EQUAL
C
      IF (IOP.EQ.5) WRITE (NOUT,340) H2,H3
      IF (IOP.NE.5) WRITE (NOUT,280)H1,H2,H3
      WRITE (NOUT,350)ARRAY(1,1,1)
      RETURN
  100 CONTINUE
      GO TO (110,130,150,210,140), IOP
C
C     1D ARRAYS
C
  110 WRITE (NOUT,250)H1,H2,H3,H4
      IF (IF.EQ.1) GO TO 120
      WRITE (NOUT,260)(I,ARRAY(I,1,1),I=1,IM)
      RETURN
  120 WRITE (NOUT,270)(I,ARRAY(I,1,1),I=1,IM)
      RETURN
C
C     2D ARRAYS
C
  130 KA=1
      MA=1
      MB=8
      GO TO 160
C
C     PARTIAL 2D ARRAY
C
  140 KA=1
      MA=IH1
      MB=IH1+7
      GO TO 160
C
C     3D ARRAYS
C
  150 KA=KM
  160 DO 200 K=1,KA
      IF (IOP.EQ.3) MA=1
      IF (IOP.EQ.3) MB=8
      IF (IOP.NE.5) WRITE (NOUT,280)H1,H2,H3,K
      IF (IOP.EQ.5) WRITE (NOUT,340)H2,H3
  170 MC=MIN0(MB,JM)
      WRITE (NOUT,300)
      WRITE (NOUT,290)(H4,L,L=MA,MC)
      WRITE (NOUT,300)
      DO 190 M=1,IM
      IF (IF.EQ.1) GO TO 180
      WRITE (NOUT,310)M,(ARRAY(M,L,K),L=MA,MC)
      GO TO 190
  180 WRITE (NOUT,320)M,(ARRAY(M,L,K),L=MA,MC)
  190 CONTINUE
      MA=MA+8
      MB=MB+8
      IF (MA.LE.JM) GO TO 170
  200 CONTINUE
      RETURN
C
C     FLUX OR SOURCE ARRAYS
C
  210 DO 240 N=1,IH1
      WRITE (NOUT,330)N
      MA=1
      MB=8
  220 MC=MIN0(MB,JM)
      WRITE (NOUT,300)
      WRITE (NOUT,290)(H4,L,L=MA,MC)
      WRITE (NOUT,300)
      DO 230 M=1,KM
      IDFB=KM+1-M
  230 WRITE (NOUT,310)IDFB,(ARRAY(N,L,IDFB),L=MA,MC)
      MA=MA+8
      MB=MB+8
      IF (MA.LE.JM) GO TO 220
  240 CONTINUE
      RETURN
C
C
  250 FORMAT (1H0,3A6//15X,A6)
  260 FORMAT (I10,E16.8)
  270 FORMAT (I10,I16)
  280 FORMAT (1H0,3A6,I6)
  290 FORMAT (8X,8(1X,A6,I5,2X))
  300 FORMAT (1H )
  310 FORMAT (I6,8E14.6)
  320 FORMAT (I6,8(2X,I10,2X))
  330 FORMAT (1H0,'COMPONENT NUMBER',I3//)
  340 FORMAT (1H0,2A6)
  350 FORMAT (1H0,'ALL ENTRIES OF THIS ARRAY EQUAL ',E12.5)
      END
