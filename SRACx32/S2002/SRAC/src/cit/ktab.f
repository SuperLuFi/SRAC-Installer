CKTAB --143 ***CITATION*** POINT NEUTRON ABSOR. FOR 3-D/ CF-OUTC
C
      SUBROUTINE KTAB(P2E,UTILE,NRGNE,NCOMP,PVOL, SS1,SS2,SS4,CONC,MJJR,
     & SOURE,IVX,JVX,KBVX,KVX,LVX,MVX,NVX,NSETVX,JIVX,NND,NNXTRA,SS5)
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/ABURN/BBURN(30),NSIG1(50),NSIG2(50),NSIG3(50),N1N2R(2,ZDX),
     &  NSIG4(50),NSIG5(50),NSIG6(50),NJM(50),NJMM(50),NJNQ(50),NCH(50),
     &  NZON(ZDX),NXSET(ZDX),NXODR(ZDX),IDXSET(ZDX),NCLASS(ZDX),NDP(ZDX)
     & , XNAME(3,ZDX)
C
      DIMENSION P2E(JIVX ,KBVX,KVX),UTILE(JVX,IVX,KBVX), NRGNE(JVX, IVX,
     &  KBVX),NCOMP(LVX),PVOL(LVX), SS1(KVX,NVX,NSETVX),SS2(KVX,NVX,
     & NSETVX),SS4(KVX,NVX,NSETVX), CONC(NVX,MVX),MJJR(200,NSETVX),
     & SOURE(JVX,IVX,KBVX)
      DIMENSION NNXTRA(NVX,NSETVX),SS5(KVX,NVX,NSETVX)
C
      IF (NND.EQ.0) GO TO 109
      DO 102 KB = 1,KBMAX
      DO 101 I = 1,IMAX
      DO 100 J = 1,JMAX
      UTILE(J,I,KB) = 0.0
  100 CONTINUE
  101 CONTINUE
  102 CONTINUE
      DO 108 NUD = 1,200
      NFLAG = 0
      DO 107 NSET = 1,NSETVX
      N = MJJR(NUD,NSET)
      IF (NNXTRA(N,NSET).NE.5) GO TO 107
      NFLAG = 1
      DO 106 KB = 1,KBMAX
      DO 105 I = 1,IMAX
      NN1 = (I-1)*JVX
      DO 104 J = 1,JMAX
      N1 = NN1+J
      L = NRGNE(J,I,KB)
      M = NCOMP(L)
      NACT = NXSET(M)
      NSEET = NXODR(NACT)
      IF (NSET.NE.NSEET) GO TO 104
      T1 = CONC(N,M)
      IF (T1.EQ.0.0) GO TO 104
      DO 103 K = 1,KMAX
      UTILE(J,I,KB) = UTILE(J,I,KB)+SS5(K,N,NSET)*P2E(N1,KB,K)
  103 CONTINUE
      UTILE(J,I,KB) = UTILE(J,I,KB)*T1
  104 CONTINUE
  105 CONTINUE
  106 CONTINUE
  107 CONTINUE
      IF (NFLAG.EQ.0) GO TO 108
      IND = 10
      IX(165) = NUD
      CALL KOUT(P2E,UTILE,IND,SOURE,IVX,JVX,KBVX,KVX,JIVX)
  108 CONTINUE
      GO TO 114
  109 NUD = IX(117)
      DO 113 KB = 1,KBMAX
      DO 112 I = 1,IMAX
      NN1= (I-1)*JVX
      DO 111 J = 1,JMAX
      N1= NN1 + J
      UTILE(J,I,KB) = 0.0
      L = NRGNE(J,I,KB)
      M = NCOMP(L)
      NACT = NXSET(M)
      NSET = NXODR(NACT)
      JM = NJM(NSET)
      NUC = MJJR(NUD,NSET)
      IF ((NUC.LE.0).OR.(NUC.GT.JM)) GO TO 111
      IF (CONC(NUC,M).EQ.0.0) GO TO 111
      T1 = CONC(NUC,M)
      DO 110 K = 1,KMAX
      UTILE(J,I,KB) = UTILE(J,I,KB)+SS1(K,NUC,NSET)* P2E(N1 ,KB,K)*T1
  110 CONTINUE
  111 CONTINUE
  112 CONTINUE
  113 CONTINUE
      IND = 3
      CALL KOUT(P2E,UTILE,IND,SOURE,IVX,JVX,KBVX,KVX,JIVX)
  114 CONTINUE
      RETURN
      END
