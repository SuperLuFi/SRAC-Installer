CBEGN --102 ***CITATION*** INITILIZE 1,2-D FLUX CALC/ CF-FLUX
C
      SUBROUTINE BEGN(XL,P2,E1,XLAMDA,IVX,JVX,KVX,LVX)
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      REAL*8 P2
      REAL*8 XLAMDA
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/AFLUX/BFLUX(30),KXMN8,NIT,NIIT,NIIIT,JXP1,KSCT1,KSCT2,
     & ISTART,IEP, VRGP1,VRGP2,VRGP3,VRG1,VRG2,VRGK1,VRGK2,XABS,PROD,
     & XLEK,RMX,RMN,XKEF1,XKEF2,XKEF3,EXFC1,EXFC2,EXFC3, NI3,IEXTR,
     & IRECV,VRGABS,LO3,LO4,XLAMDB,EPI1,EPI2, BETTA,SUMXI,IX25,IX28,I,J,
     &  KB,K,ITMAX,ITIME, BET(MSX),DEL(MSX)
C
      DIMENSION XL(6,KVX)
      DIMENSION P2(JVX,IVX,KVX)
      DIMENSION E1(LVX,KVX)
C
      NTITE = IX(198)
      IF (IX(172).GT.0) GO TO 101
      IF (NTITE.NE.0) GO TO 100
      IF ((NGC(2).NE.0).AND.(NUAC(2).EQ.0)) GO TO 101
  100 CONTINUE
      VRGK2 = BETTA
      SPARE(39) = BETTA
  101 CONTINUE
      NOIR = NUAC(23)
      DO 103 K = 1,KMAX
      DO 102 L = 1,LMAX
      E1(L,K) = 0.0
  102 CONTINUE
  103 CONTINUE
      DO 106 K = 1,KMAX
      DO 105 I = 1,IMAX
      DO 104 J = 1,JMAX
      IF (P2(J,I,K).EQ.0.0) GO TO 104
      IX(10) = I
      IX(11) =J
      IX(13) = K
      GO TO 107
  104 CONTINUE
  105 CONTINUE
  106 CONTINUE
  107 CONTINUE
      VRGK1 = 1.0
      IF (IX(24).EQ.0) GO TO 108
      WRITE(IOUT,1009)
      IF (NUAC(3).EQ.0) VRGK1 = 0.0
      GO TO 134
  108 CONTINUE
      XLAMDA = XLAMDB
      IF (IX(172).GT.0) GO TO 110
      IF (NTITE.NE.0) GO TO 109
      IF (NGC(2).NE.0.AND.NUAC(2).EQ.0) GO TO 110
  109 CONTINUE
      XLAMDA = 1.0
  110 CONTINUE
      IF (IX(5).GE.2) XLAMDA = 1.0/XSRH1(1)
C
C***************************SEARCH OPTIONS******************************
      IF ((IX(5).EQ.0).OR.(IX(5).GE.2)) GO TO 123
      IF (IX(5).EQ.(-5)) GO TO 123
      IF (IX(172).GT.0) GO TO 112
      IF (NTITE.NE.0) GO TO 111
      IF ((NGC(2).NE.0).AND.(NUAC(2).EQ.0)) GO TO 112
  111 CONTINUE
      XLAMDA = 1.0
      XKEF1 = 1.0
      SPARE(45) = 1.0
      SPARE(46) = 0.1
      IF ((IX(5).EQ.-1).OR.(IX(5).EQ.1)) XLAMDA = 0.0
  112 CONTINUE
      IF ((NGC(1).GT.0).AND.(IX(2).GT.1)) GO TO 119
      WRITE(IOUT,1007)(TITL1(I),I=1,18)
      WRITE(IOUT,1008) (TITL2(I),I=1,18)
      IF (NGC(1).EQ.0) GO TO 116
      IF (IX(2).GT.0) GO TO 113
      WRITE(IOUT,1000)IX(3),SPARE(12)
      GO TO 116
  113 CONTINUE
      IF (IX(99).EQ.0) GO TO 114
      WRITE(IOUT,1001)IX(3),SPARE(12)
      GO TO 115
  114 CONTINUE
      WRITE(IOUT,1006)IX(3),SPARE(2),SPARE(12)
  115 CONTINUE
  116 CONTINUE
      IF (NUAC(20).LE.0) GO TO 117
      WRITE(IOUT,1010)NOIR
      GO TO 118
  117 CONTINUE
      WRITE(IOUT,1011)NOIR
  118 CONTINUE
      WRITE(IOUT,1005)SPARE(51),SPARE(57)
      GO TO 122
  119 CONTINUE
      IF (IX(99).EQ.0) GO TO 120
      WRITE(IOUT,1001)IX(3),SPARE(12)
      GO TO 121
  120 CONTINUE
      WRITE(IOUT,1006)IX(3),SPARE(2),SPARE(12)
  121 CONTINUE
  122 WRITE(IOUT,1012)
      GO TO 136
  123 CONTINUE
      IF (IX(172).GT.0) GO TO 125
      IF (NTITE.NE.0) GO TO 124
      IF ((NGC(2).NE.0).AND.(NUAC(2).EQ.0)) GO TO 125
  124 CONTINUE
      XKEF1 = 1.0
  125 CONTINUE
      IF (XLAMDA.NE.0.0) XKEF1 = 1.0/XLAMDA
      IF ((NGC(1).GT.0).AND.(IX(2).GT.1)) GO TO 131
      WRITE(IOUT,1007)(TITL1(I),I=1,18)
      WRITE(IOUT,1008) (TITL2(I),I=1,18)
      IF (NGC(1).EQ.0) GO TO 129
      IF (IX(2).GT.0) GO TO 126
      WRITE(IOUT,1000) IX(3),SPARE(12)
      GO TO 129
  126 CONTINUE
      IF (IX(99).EQ.0) GO TO 127
      WRITE(IOUT,1001)IX(3),SPARE(12)
      GO TO 128
  127 CONTINUE
      WRITE(IOUT,1006)IX(3),SPARE(2),SPARE(12)
  128 CONTINUE
  129 CONTINUE
      IF (IX(5).EQ.(-5)) WRITE(IOUT,1002)
      IF (NUAC(20).LE.0) GO TO 130
      WRITE(IOUT,1010)NOIR
      GO TO 134
  130 CONTINUE
      WRITE(IOUT,1011)NOIR
      GO TO 134
  131 CONTINUE
      IF (IX(99).EQ.0) GO TO 132
      WRITE(IOUT,1001)IX(3),SPARE(12)
      GO TO 133
  132 CONTINUE
      WRITE(IOUT,1006)IX(3),SPARE(2),SPARE(12)
  133 CONTINUE
  134 CONTINUE
      IF (IX(5).EQ.(-5)) GO TO 135
      WRITE(IOUT,1013)
      GO TO 136
  135 WRITE(IOUT,1003)
      XLAMDA = 1.0
      XKEF1 = 1.0
      SPARE(46) = 0.1
  136 CONTINUE
      IF (NTITE.NE.0) GO TO 137
      IX(196) = 0
      IF ((NGC(2).NE.0).AND.(NUAC(2).EQ.0)) IX(196) = 1
      IF ((NGC(2).NE.0).AND.(NUAC(2).EQ.0)) GO TO 138
  137 CONTINUE
      KXMN8 = KMAX-IX(29)
      KXMN8 = MAX0(KXMN8,1)
      IEP = 1
      JXP1 = JMAX+1
      IX25 = IX(25)
      IX28 = IX(28)
      NIT = 0
      IEXR = 0
      IRECV = 0
      NIIT = 0
      NIIIT = 0
      LO3 = 0
      LO4 = 0
      VRG1 = 1.0
      VRGP1 = 1.0
      XKEF2 = 2.0
  138 CONTINUE
      IF (IX(5).EQ.(-5)) XKEF2 = 1.0
      IF (IX(24).NE.0) GO TO 141
      DO 140 K = 1,KMAX
      DO 139 N = 1,6
      XL(N,K) = 0.0
  139 CONTINUE
  140 CONTINUE
  141 CONTINUE
C     WRITE(IOUT,1004)NTITE,NGC(2),NUAC(2),KXMN8,IEP,JXP1,IX25,IX28,
C    & NIT,IEXR,IRECV,NIIT,NIIIT,LO3,LO4,VRG1,VRGP1,XKEF2
      RETURN
 1000 FORMAT('0AN INITILIZATION FLUX - EIGENVALUE PROBLEM FOLLOWS FOR',
     &'CYCLE',I3,'  TOTAL DEPLETION TIME',F8.2,' DAYS'//)
 1001 FORMAT('0A FINAL FLUX - EIGENVALUE PROBLEM FOLLOWS FOR CYCLE',I3,
     &  '  TOTAL DEPLETION TIME',F11.3,' DAYS')
 1002 FORMAT(1H0,'A FIXED SOURCE PROBLEM FOLLOWS')
 1003 FORMAT(1H ,'ITERATION  FLUX CHANGE',4X,'BETA',6X,'MU-1',6X,'MU-2',
     &  6X,'MU-3',4X,'DRIVE FACTOR',7X,'BALANCE')
 1004 FORMAT(1H0,15I4,1P3E13.5)
 1005 FORMAT(' LIMITING VALUES OF THE SEARCH FACTOR FOR ABSORPTION AND',
     &' TOTAL LOSS ARE',1P2E13.5)
 1006 FORMAT('0A FLUX - EIGENVALUE PROBLEM FOLLOWS FOR CYCLE',I3,
     & ' CYCLE TIME',0PF11.4,' DAYS   TOTAL TIME',F11.4,' DAYS'//)
 1007 FORMAT(1H1,18A4)
 1008 FORMAT(1H ,18A4)
 1009 FORMAT(1H0,'ADJOINT PROBLEM FOLLOWS')
 1010 FORMAT(1H ,'LINE RELAXATION WILL BE DONE ON ROWS - ',I3,
     & ' INNER ITERATION(S)')
 1011 FORMAT(' LINE RELAXATION WILL BE DONE ON ROWS AND COLUMNS - ',I3,
     &  ' INNER ITERATION(S)')
 1012 FORMAT(' ITERATION  FLUX CHANGE    BETA      MU-1      MU-2     ',
     &' MU-3            K     SEARCH FACTOR')
 1013 FORMAT(' ITERATION  FLUX CHANGE    BETA      MU-1      MU-2',
     &' MU-3            K')
      END
