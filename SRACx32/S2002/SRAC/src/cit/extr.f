CEXTR --079***CITATION*** EXTRAPOLATION SUBROUTINE/CF FLUX,KLUX
C
      SUBROUTINE EXTR
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/AFLUX/BFLUX(30),KXMN8,NIT,NIIT,NIIIT,JXP1,KSCT1,KSCT2,
     & ISTART,IEP, VRGP1,VRGP2,VRGP3,VRG1,VRG2,VRGK1,VRGK2,XABS,PROD,
     & XLEK,RMX,RMN,XKEF1,XKEF2,XKEF3,EXFC1,EXFC2,EXFC3, NI3,IEXTR,
     & IRECV,VRGABS,LO3,LO4,XLAMDA,EPI1,EPI2, BETTA,SUMXI,IX25,IX28,I,J,
     &  KB,K,ITMAX,ITIME, BET(MSX),DEL(MSX)
C
      DIMENSION RP(10)
C
      IF (IX(196).EQ.0) GO TO 101
      IX(196) = 0
      NTITE = IX(198)
      IF (NTITE.NE.0) GO TO 101
      IF ((NGC(2).EQ.0).OR.(NUAC(2).NE.0)) GO TO 101
      ISK = IX(160)
      IEXR = IX(161)
      NI3 = IX(162)
      IC10 = IX(163)
      IC20 = IX(164)
      IBCUT = IX(197)
      XXMU = SPARE(31)
      XOMU = SPARE(32)
      VVVV = SPARE(33)
      XUSQ = SPARE(40)
      DO 100 I = 1,10
      I1 = 160+I
      RP(I) = SPARE(I1)
  100 CONTINUE
  101 CONTINUE
      IX135 = IX(135)
      IX(135) = 0
      NA = IX(35)
  102 NIT = NIT+1
      IF (NIT.EQ.1) ISK = 0
      IF ((IX(172).GT.0).AND.(NIT.EQ.1)) GO TO 105
      IF (IX(172).GT.0) GO TO 109
      IF (NIT-30) 103,103,109
  103 IF (NIT-1) 104,104,106
  104 CONTINUE
      ISK = 0
      IBCUT=NUAC(19)
      IF (IBCUT.GT.0) GO TO 105
      XUSQ=1.0-(2.0/BETTA-1.0)**2
      SPARE(40) = XUSQ
      BETTA=2.0/(2.0-XUSQ)
  105 IEXR = 0
      NI3 = 0
      VOG1 = 1.0
      IC10 = 12
      IC20 = 20
      GO TO 108
  106 IF (IBCUT) 107,107,109
  107 X=1.0-0.25*XUSQ*BETTA
      IF (X.LE.0.) GO TO 109
      BETTA=AMIN1(1.0/X,1.9999)
  108 VRGK2=BETTA
      SPARE(39)=BETTA
  109 CONTINUE
      NIIT = NIIT+1
      IF (NIIT-3) 111,110,111
  110 IEXR = 1
  111 CONTINUE
      IX(32) = 0
      IX(33) = 0
  112 VRG2 = VRG1
      VRGP2 = VRGP1
      EXFC3 = EXFC2
      EXFC2 = EXFC1
      VOG2 = VOG1
      NI3 = NI3+1
      XO1 = ABS( RMX-1.0)
      XO2 = ABS( RMN-1.0)
      VRGP1 = AMAX1(XO1,XO2)
      IEP = 0
      IF ((NUAC(18).GT.0).OR.(VRGP1.LT.0.01)) GO TO 114
  113 IEP = 1
  114 CONTINUE
  115 IF (XO1-XO2) 116,116,117
  116 VRG1 = RMN-1.0
      VOG1 = RMX-1.0
      VVVV = RMN
      GO TO 118
  117 VRG1 = RMX-1.0
      VOG1 = RMN-1.0
      VVVV = RMX
  118 IF (VRG2.EQ.0.0) GO TO 165
      YYMU = ABS(XXMU)
      XXMU = (VRG1/VRG2)*(1.0+VRG2)
      XOMU = XXMU
      IF (VOG2) 119,120,119
  119 XOMU = (VOG1/VOG2)*(1.0+VOG2)
  120 CONTINUE
      VRGABS = 1.0
      EXFC1 = 1.0
      EOFC1 = 1.0
      T35 = 1.0-XXMU
      T36 = 1.0-XOMU
      IF (T35) 121,122,121
  121 VRGABS = VRG1/T35
      EXFC1 = XXMU/T35
  122 IF (T36) 123,124,123
  123 EOFC1 = XOMU/T36
  124 CONTINUE
      SPARE(31) = XXMU
      SPARE(32) = XOMU
      SPARE(33) = VVVV
  125 XMUAV = (XXMU+XOMU)*0.5
      IF (XMUAV.NE.1.) GO TO 126
      EXFC1=1.0
      GO TO 127
  126 EXFC1 = XMUAV/(1.0-XMUAV)
  127 SPARE(34) = EXFC1
      IF (VVVV.EQ.0.0) GO TO 128
      VRGABS = EXFC1*(1.0-1.0/VVVV)
  128 CONTINUE
      IF (VRGP2.EQ.0.0) PROUT = 1.0
      IF (VRGP2.EQ.0.0) GO TO 129
      PROUT = VRGP1/VRGP2
  129 CONTINUE
      IF (ISK.EQ.0) GO TO 131
      DO 130 N = 1,7
      RP(N) = RP(N+1)
  130 CONTINUE
      RP(8) = PROUT
  131 CONTINUE
      IF (NIIT-IC10) 132,132,133
  132 IF (ISK.GT.0) GO TO 141
      IF (IEXR) 165,165,150
  133 IF (ISK.GT.0) GO TO 134
      NIIIT = NIIIT+1
      RP(NIIIT) = PROUT
  134 CONTINUE
      IF (NIIT-IC20) 132,135,135
  135 NIIT = 0
      ISK = 1
      NIIIT = 0
      IC10 = 2
      IC20 = 10
  136 CONTINUE
  137 IF (ABS(VRG1)-10.0) 139,138,138
  138 BETTA = 0.2+0.8*BETTA
      VRGK2=BETTA
      SPARE(39)=BETTA
      IBCUT=1
      ISK = 0
      GO TO 163
  139 IF (ABS(VRG1)-2.0) 141,140,140
  140 IF (ABS(XMUAV)-1.0) 141,138,138
  141 CONTINUE
      IF (NIT.LE.30) GO TO 142
      IF ((ABS(XXMU).GT.1.3).AND.(YYMU.GT.1.3)) GO TO 161
  142 CONTINUE
      III = 0
      DO 145 IIII = 1,8
  143 IF (RP(IIII)-1.0) 145,144,144
  144 III = III+1
  145 CONTINUE
  146 IF (III-2) 147,148,148
  147 NPOS = 0
      GO TO 149
  148 NPOS = 1
  149 IF (NPOS) 150,150,161
  150 CONTINUE
      IF (IX(129).GT.0) NI3 = 0
      IF (NI3-NA) 165,151,151
  151 IF (ABS(XMUAV)-1.0) 152,165,165
  152 IF (ABS(XXMU)-1.0) 153,165,165
  153 CONTINUE
      IF (EXFC2.EQ.0) GO TO 155
      IF (ABS(EXFC1/EXFC2-1.0)-0.05) 154,154,155
  154 CONTINUE
      IF (NIT.LT.NUAC(22)-1) GO TO 155
      IF (IX135.EQ.1) GO TO 156
      IX(135) = 1
  155 IEXR = 1
      GO TO 165
  156 CONTINUE
      IF ((EXFC1*SPARE(35)).LT.0.0) GO TO 155
      IEXR = 0
      NIIT = 0
      ISK = 0
      NIIIT = 0
      NI3 = 0
      VOGP1 = ABS(RMN-1.0)
      P98T = EXFC1
      IF (NUAC(18).GT.0) GO TO 157
      IF (VOGP1.EQ.0.0) GO TO 157
C     SEQUENCE
      O98 = 0.9
      P98T = O98*(1.0-VOGP1)/VOGP1
  157 CONTINUE
  158 CONTINUE
  159 T1 = NUAC(21)
      IF (T1.EQ.0.0) T1 = 75.0
  160 EXFC1 = AMIN1(EXFC1,P98T,T1)
      IX(32) = 1
      IC10 = 12
      IC20 = 20
      NI3 = 0
      GO TO 165
  161 CONTINUE
  162 BETTA = (6.0*BETTA+1.0)/7.0
      VRGK2=BETTA
      SPARE(39)=BETTA
      IBCUT=1
      ISK = 0
  163 CONTINUE
  164 IX(33) = 1
      NI3 = 0
  165 CONTINUE
      IX(197) = IBCUT
      IX(160) = ISK
      IX(161) = IEXR
      IX(162) = NI3
      IX(163) = IC10
      IX(164) = IC20
      SPARE(160) = VOG1
      DO 166 I = 1,10
      I1 = 160+I
      SPARE(I1) = RP(I)
  166 CONTINUE
      RETURN
 1000 FORMAT(1H ,'      BETTA = ',F12.5)
      END
