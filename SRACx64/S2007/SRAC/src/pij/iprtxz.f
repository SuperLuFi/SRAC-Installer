      SUBROUTINE IPRTXZ(HOL,MESHX,MESHP)
      DIMENSION MESHX(NX,1),MESHP(4,NDPIN,NX1,NY1)
      COMMON / PIJ1C / NX,NY,NTPIN,NAPIN,NCELL,NM,NGR,NGD,NDPIN,
     1                 IDIVP,BETM,NX1,NY1,IDUM(6),NDPIN1
      COMMON /MAINC/ DUM1(63),NOUT1,NOUT2,DUM2(35),CASENM(2),TITLE(18)
C
      CHARACTER*12 AST,BLK,SUBSTR
      CHARACTER*8  HOL
CBUG FIX 98/10/19 +
C     CHARACTER*132 OUTSTR
      CHARACTER*136 OUTSTR
CBUG FIX 98/10/19 -
      CHARACTER*3 AST3,BLK3
C
      DATA AST/'************'/,BLK/'  *         '/
      DATA AST3/'***'/,BLK3/'  *'/
C
      I0=1
  100 I1=MIN0(NX,I0+9)
      N8=12*(I1-I0)
      LINE=60
      DO 200 J=1,NY1
      IF(LINE.LT.60) GO TO 140
      WRITE(NOUT2,8000) CASENM,TITLE,HOL
 8000 FORMAT(1H1///10X,2A4,'**',18A4,5H**** ,A8,' NUMBER ****')
 8001 FORMAT(5X,I2,10I12)
CBUG FIX 98/10/19 +
C8002 FORMAT(4X,10A12)
 8002 FORMAT(4X,11A12)
CBUG FIX 98/10/19 -
 8003 FORMAT(1H(,I3,1H))
 8004 FORMAT(1H<,I3,5H>   *)
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
      WRITE(NOUT2,8001) (I-1,I=I0,I1+1)
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
      LINE=6
  140 CONTINUE
      JSCAN=0
      DO 180 JJ=NDPIN,1,-1
      IF(JJ.EQ.NDPIN) THEN
      WRITE(OUTSTR(1:4),'(I3,1H )') J-1
      DO 150 N=I0,I1
  150 OUTSTR(1:12*(N-I0)+16)=OUTSTR(1:12*(N-I0)+4)//AST
      OUTSTR(1:12*(I1-I0)+19)=OUTSTR(1:12*(I1-I0)+15)//AST3
                      ELSE
      OUTSTR(1:4)='    '
      DO 160 N=I0,I1
  160 OUTSTR(1:12*(N-I0)+16)=OUTSTR(1:12*(N-I0)+4)//BLK
      OUTSTR(1:12*(I1-I0)+19)=OUTSTR(1:12*(I1-I0)+16)//BLK3
                      ENDIF
C **  SCAN IF PIN ROD LOCATED
      ISCAN=0
      DO 170 I=I0,I1+1
      IF(MESHP(1,JJ,I,J).NE.0) THEN
      WRITE(SUBSTR,8003) MESHP(1,JJ,I,J)
      OUTSTR(12*(I-I0)+2:12*(I-I0)+6)=SUBSTR(1:5)
      ISCAN=ISCAN+1
                               ENDIF
      IF(MESHP(2,JJ,I,J).NE.0) THEN
      WRITE(SUBSTR,8003) MESHP(2,JJ,I,J)
      OUTSTR(12*(I-I0)+8:12*(I-I0)+12)=SUBSTR(1:5)
      ISCAN=ISCAN+1
                               ENDIF
  170 CONTINUE
      IF(ISCAN.NE.0) THEN
      JSCAN=JSCAN+1
      WRITE(NOUT2,'(A)') OUTSTR(1:12*(I1-I0)+19)
      LINE=LINE+1
                     ENDIF
  180 CONTINUE
      DO 280 JJ=1,NDPIN
      IF(JJ.EQ.NDPIN) THEN
      WRITE(OUTSTR(1:4),'(I3,1H )') J-1
      DO 250 N=I0,I1
  250 OUTSTR(1:12*(N-I0)+16)=OUTSTR(1:12*(N-I0)+4)//AST
      OUTSTR(1:12*(I1-I0)+19)=OUTSTR(1:12*(I1-I0)+15)//AST3
                      ELSE
      OUTSTR(1:4)='    '
      DO 260 N=I0,I1
  260 OUTSTR(1:12*(N-I0)+16)=OUTSTR(1:12*(N-I0)+4)//BLK
      OUTSTR(1:12*(I1-I0)+19)=OUTSTR(1:12*(I1-I0)+16)//BLK3
                      ENDIF
C **  SCAN IF PIN ROD LOCATED
      ISCAN=0
      DO 270 I=I0,I1+1
      IF(MESHP(3,JJ,I,J).NE.0) THEN
      WRITE(SUBSTR,8003) MESHP(3,JJ,I,J)
      OUTSTR(12*(I-I0)+2:12*(I-I0)+6)=SUBSTR(1:5)
      ISCAN=ISCAN+1
                               ENDIF
      IF(MESHP(4,JJ,I,J).NE.0) THEN
      WRITE(SUBSTR,8003) MESHP(4,JJ,I,J)
      OUTSTR(12*(I-I0)+8:12*(I-I0)+12)=SUBSTR(1:5)
      ISCAN=ISCAN+1
                               ENDIF
  270 CONTINUE
      IF(ISCAN.NE.0) THEN
      JSCAN=JSCAN+1
      WRITE(NOUT2,'(A)') OUTSTR(1:12*(I1-I0)+19)
      LINE=LINE+1
                     ENDIF
  280 CONTINUE
      IF(JSCAN.EQ.0) THEN
      WRITE(OUTSTR(1:4),'(I3,1H )') J-1
      DO 290 N=I0,I1
  290 OUTSTR(1:12*(N-I0)+16)=OUTSTR(1:12*(N-I0)+4)//AST
      WRITE(NOUT2,'(A)') OUTSTR(1:12*(I1-I0)+19)
      LINE=LINE+1
                     ENDIF
C     LINE=LINE+NDPIN
      IF(J.EQ.NY1) GO TO 200
C *** MODERATOR REGION
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
      LINE=LINE+1
      WRITE(OUTSTR,8002) (BLK,I=I0,I1+1)
      DO 190 I=I0,I1
      WRITE(SUBSTR,8004) MESHX(I,J)
      OUTSTR(12*(I-I0)+11:12*(I-I0)+19)=SUBSTR(1:9)
  190 CONTINUE
      WRITE(NOUT2,'(A)') OUTSTR(1:12*(I1-I0)+19)
      WRITE(NOUT2,8002) (BLK,I=I0,I1+1)
      LINE=LINE+2
  200 CONTINUE
      IF(I1.GE.NX) RETURN
      I0=I1+1
      GO TO 100
      END
