CDODA --127 ***CITATION*** WRITE B*CHI*SUM(NU*SIGF*V*PHI/K)  CF/EIGN
C
      SUBROUTINE DODA(P1,P1E,P2,P2E,NRGN,NRGNE,XI,XKEF1, JVX,IVX,KBVX,
     & KVX,LVX,JIVX,SIG,PVOL,NCOMP,MVX,SOUR,SOURE)
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      REAL*8 P2
      REAL*8 SOUR
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
C
      DIMENSION P1(JVX,IVX) ,XI(KVX,MVX),NRGN(JVX,IVX)
      DIMENSION P2(JVX,IVX,KVX)
      DIMENSION P1E(JIVX,KBVX) ,NRGNE(JVX,IVX,KBVX)
      DIMENSION P2E(JIVX,KBVX,KVX)
      DIMENSION SIG(KVX,MVX,10),PVOL(LVX),NCOMP(LVX)
      DIMENSION SOUR(JVX,IVX),SOURE(JVX,IVX,KBVX)
C
      IOFS = IX(84)
      REWIND IOFS
      B = 1.0
      IF (GLIM(5).NE.0.0) B = GLIM(5)
      B = B/XKEF1
      IF (NUAC(5).GT.10) GO TO 108
      DO 102 I=1,IVX
      DO 101 J=1,JVX
      L = NRGN(J,I)
      M = NCOMP(L)
      X = 0.0
      DO 100 K=1,KVX
      X = X + SIG(K,M,4)*P2(J,I,K)
  100 CONTINUE
      SOUR(J,I) = X*PVOL(L)
  101 CONTINUE
  102 CONTINUE
      DO 105 K=1,KVX
C     X = B*XI(K)
      DO 104 I=1,IVX
      DO 103 J=1,JVX
      L = NRGN(J,I)
      M = NCOMP(L)
      X = B*XI(K,M)
      P1(J,I) = SOUR(J,I)*X
  103 CONTINUE
  104 CONTINUE
      WRITE(IOFS) ((P1(J,I),J=1,JVX),I=1,IVX)
  105 CONTINUE
      DO 107 I=1,IVX
      DO 106 J=1,JVX
      P1(J,I) = 0.0
      SOUR(J,I) = 0.0
  106 CONTINUE
  107 CONTINUE
      GO TO 120
  108 CONTINUE
      DO 112 KB=1,KBVX
      DO 111 I=1,IVX
      DO 110 J=1,JVX
      L = NRGNE(J,I,KB)
      M = NCOMP(L)
      N1 = (I-1)*JVX + J
      X = 0.0
      DO 109 K=1,KVX
      X = X + SIG(K,M,4)*P2E(N1,KB,K)
  109 CONTINUE
      SOURE(J,I,KB) = X*PVOL(L)
  110 CONTINUE
  111 CONTINUE
  112 CONTINUE
      JIP = JVX*IVX
      DO 116 K=1,KVX
C     X = B*XI(K)
      DO 115 KB=1,KBVX
      N1 = 0
      DO 114 I=1,IVX
      DO 113 J=1,JVX
      L = NRGNE(J,I,KB)
      M = NCOMP(L)
      X = B*XI(K,M)
      N1 = N1 + 1
      P1E(N1,KB) = SOURE(J,I,KB)*X
  113 CONTINUE
  114 CONTINUE
  115 CONTINUE
      WRITE(IOFS) ((P1E(N1,KB),N1=1,JIP),KB=1,KBVX)
  116 CONTINUE
      DO 119 KB=1,KBVX
      N1 = 0
      DO 118 I=1,IVX
      DO 117 J=1,JVX
      N1 = N1 + 1
      P1E(N1,KB) = 0.0
      SOURE(J,I,KB) = 0.0
  117 CONTINUE
  118 CONTINUE
  119 CONTINUE
  120 CONTINUE
      REWIND IOFS
      WRITE(IOUT,1000)
      RETURN
 1000 FORMAT('0 BETA*CHI*SUM(NU*SIGF*V*PHI/K) HAS BEEN WRITTEN ON LOG',
     &'ICAL 17')
      END
