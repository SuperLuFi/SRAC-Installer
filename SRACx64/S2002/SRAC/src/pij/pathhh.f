      SUBROUTINE PATHHH
      COMMON / PIJ1C / NX,NY,NTPIN,NAPIN,NCELL,NM,NGR,NGA,
     1            NDPIN,IDIVP,BETM,NX1,IDUM13(7),NDPIN1,NDR,NDA,
     2            IDUM23(2),RO1,DRO,IDUM27(9),NZP
      COMMON / PIJ2C / IGT,NZ,NR,NRR,NXR,IBOUND,IDRECT,LCOUNT,IEDPIJ,
     1               IFORM,NTTAB,NUTAB,SZ,IDUM2(26)
     2              ,LCMMR,LCNREG,LCIRR,LCIXR,LCMAR,LCMAT,LCVOL,
     3               LCVOLR,LCVOLX,LCVOLM,NO2,AA(950)
      COMMON / MAINC / DDM(63),NOUT1,NOUT2,IT0,DDM67(29),MXDIM,DM97(4),
     1                 CASENM(2),TITLE(18),DDM2(880)
      COMMON / PIJC / L00,L01,L02,L03,L04,L05,L06,L07,L08,
     1              L09,L10,L11,L12,L13,L14,L15,L16,L17,L18,L19,L20,
     2              L21,L22,L23,L24,L25,L26,L27,L28,L29,L30,L31,L32,
     3              L33,L34,L35,DD(65)
      COMMON /WORK/A(30000)
C     L01=1
C 1   RX  BY L01
C     L02 =L01 + NX1+NAPIN
C 2   RPP BY L02
C     IF(IGT.GE.11 .AND IGT.LE.14) L03 = L02 + NTPIN
C 3   RDP BY L03
C     L04 = L03 + NDPIN1
C 4   NPIN  BY L04
C     L05=L04+  + NAPIN
C 5   THETA BY L05
C     L06 = L05 + NTPIN
C 6   TY    BY L06
C     L08 = L06 + NY1
C 8   D     BY L08
C     L09 = L08 + NTTAB
C 9   IM    BY L09
C     L10 = L09 + NTTAB
C 10  IP    BY L10
C     L11 = L10 + NTTAB
C 11  II    BY L11
C     L12 = L11 + NTTAB
C 12  XX    BY L12
C     L14 = L12 + NTTAB
C 14  S     BY L14
C     L25 = L14 + NR
C 25  X
C     L26 = L25 + NUTAB
C 26  III
C     L27 = L26 + NUTAB
C 27   V
      L28 = L27 + NZ
C 28  NTR
      L29 = L28 + NAPIN
C 29  NAMEP
      LAST= L29 +2*NDPIN*NAPIN
C 30  LAST
      IF(LAST.LE.MXDIM) GO TO 100
      LAST=LAST-MXDIM
      WRITE(NOUT1,9000) LAST,MXDIM
      WRITE(NOUT2,9000) LAST,MXDIM
      STOP
  100 CONTINUE
      WRITE(NOUT1,9010) LAST,MXDIM
      WRITE(NOUT2,9010) LAST,MXDIM
C MERGE RPP INTO RX , REDEFINE NX, NX1 AND  DEFINE NPTX
             IF(NAPIN.GT.0)
     &       CALL MERGRX(A(L01),A(L28),A(L02),A(L08))
 9000 FORMAT(18H0//DIMENSION OVER.,I7,6H FROM ,I7,' IN PATHHH=STEP'/)
 9010 FORMAT(1H0,9X,' STORAGE USED',I7,' WITHIN',I7,' IN PATHHH=STEP')
C
       CALL PREHH(A(L01),A(L02),A(L03)
     1           ,A(L04),A(L05),A(L27),A(L28),A(L29))
C
       CALL VOLPIJ(AA(LCNREG),AA(LCIRR),AA(LCIXR),
     2  AA(LCMMR),A(L27),AA(LCVOL),AA(LCVOLR),AA(LCVOLX),AA(LCVOLM))
C
      CALL MAKETX(AA(LCNREG),AA(LCIRR),AA(LCMMR),AA(LCVOL)
     1 ,A(L01),A(L02),A(L03),A(L04),A(L04+NTPIN),A(L05),A(L06)
     2 ,A(L08),A(L09),A(L10),A(L11),A(L12),A(L14),A(L25),A(L26)
     3 ,A(L28),A(L29),A(L30),A(L31),A(L33))
      RETURN
      END
