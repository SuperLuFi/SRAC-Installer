CWFCC-VP-086    CONTROL FOR WRITING FM FIXED INTERFACE DATA/ CF-CALR
C
      SUBROUTINE WFCC(A,MEMORY, IFIO)
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     & NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/AMESH/BMESH(30),NREGI,NREGJ,NREGKB,XSHI(RGX),XSHJ(RGX),
     & XSHKB(RGX), MSHI(RGX),MSHJ(RGX),MSHKB(RGX),Y(MSX),YY(MSX), X(MSX)
     &,XX(MSX),Z(MSX),ZZ(MSX),ZONVOL(ZNEX),AVZPD(ZNEX),PDI(MSX),PDJ(MSX)
     & , PDK(MSX)
      COMMON/ABURN/BBURN(30),NSIG1(50),NSIG2(50),NSIG3(50),N1N2R(2,ZDX),
     &  NSIG4(50),NSIG5(50),NSIG6(50),NJM(50),NJMM(50),NJNQ(50),NCH(50),
     &  NZON(ZDX),NXSET(ZDX),NXODR(ZDX),IDXSET(ZDX),NCLASS(ZDX),NDP(ZDX)
     & , XNAME(3,ZDX)
      COMMON/AKADD/KAY(1),K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11, K12,K13,
     & K131,K14,K15,K16,K17,K18,K19,K20,K21,K22,K23,K24, K25,K26,K27,
     & K28,K29,K30,K31,K32,K33,K34,K35,K36,K37, K38,K39,K40,K41,K42,K43,
     & K44,K45,K46,K47,K48,K49, K50,K51,K52,K53,K54,K55,K56,K57,K58,K59,
     & K60,K61,K62, K63,K64,K65,K66,K67,K68,K69,K70,K71,K72,K73,K74,K75,
     &  K76,K77,K78,K79,K80,K81,K82,K83,K84,K85,K86,K87, K88,K89,K90,
     & K91,K92,K93,K94,K95,K96,K97,K98, K99,K100,NDATA,KNRGN,KNCOMP,
     & KPVOL,KRVOL,MEMVRY,MEMX
      COMMON/AVDLM/IVDLM(1),IVX,JVX,KBVX,KVX,LVX,MVX,NVX,IVXP1,JVXP1,
     & KBVXP1,NSETVX,NVO,IVO,IVZ,KVZ,NCRP,NSPA,N3DDIM,NBLOCK, JIVX,
     & JIP1VX,JP1IXZ,IOVX,IOVZ
C
      DIMENSION A(MEMORY)
C
      NONNN = 200
CHH   NUMB = 100+4*NONNN+NVX*NSETVX+NONNN*NSETVX+ 4*NONNN+7*MVX+6*NSETVX
      NUMB = 800+4*NONNN+NVX*NSETVX+NONNN*NSETVX+ 4*NONNN+7*MVX+6*NSETVX
      N1 = KNRGN-K14
      IF (N1.GE.NUMB) GO TO 100
      WRITE(IOUT,1000)N1,NUMB
      STOP
  100 CONTINUE
      NLIM = K14+NUMB
      REWIND IO1
      WRITE(IO1)(A(I),I=K14,NLIM)
      END FILE IO1
      REWIND IO1
      DO 101 I = K14,NLIM
      A(I) = 0.0
  101 CONTINUE
      L1 = K14
      IF ((L1/2)*2.EQ.L1) L1 = L1+1
CHH   L2 = L1+100
      L2 = L1+800
      IF ((L2/2)*2.EQ.L2) L2 = L2 + 1
      L3 = L2+2*NONNN
      L4 = L3+NONNN
      L5 = L4+NONNN
      L6 = L5+NVX*NSETVX
      L7 = L6+NONNN*NSETVX
      L8 = L7+4*NONNN
      L9 = L8+7*MVX
      L10 = L9+6*NSETVX
      CALL WFAC(A(K8),A(K9),A(K10),A(L1),A(L2),A(L3), A(L4),A(L5),A(L6),
     & A(L7),A(L8),A(L9),A(KNCOMP),A(KRVOL), NVX,NSETVX,NONNN,MVX,IVO,
     & IFIO,LVX)
      READ(IO1)(A(I),I=K14,NLIM)
      REWIND IO1
      RETURN
 1000 FORMAT(1H0'ERROR STOP 31, HAVE'I7,'    NEED'I7)
      END
