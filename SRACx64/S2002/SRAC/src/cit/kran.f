CKRAN --131***CITATION***TRANSFERS INPUT DATA FROM KO3 TO KO10/CF-WSTR
C
      SUBROUTINE KRAN(CONC,MVX,NVX,KO3,KO10,HOX,NFO,NNFO,NIC,NSETVX)
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
C
      DIMENSION CONC(NVX,MVX)
      DIMENSION HOX(NVX,NSETVX,20),NFO(20,NSETVX),NNFO(20,NSETVX),
     & NIC(1000)
C
  100 READ(KO3,END=118) INSEC,NREC,NSET,I1,I2
      WRITE(KO10) INSEC,NREC,NSET,I1,I2
      IF (INSEC.EQ.28) GO TO 101
      IF (INSEC.EQ.40) GO TO 108
      IF (INSEC.EQ.36) GO TO 115
      IF (INSEC.EQ.30) GO TO 116
C******ADD AN IF FOR EACH NEW SECT. ON IO10
      GO TO 100
  101 IF (NSET.EQ.0) GO TO 100
      DO 107 N=1,NSET
      READ(KO3) (NSRH(I),I=1,24),(XSRH1(I),I=1,6)
      WRITE(KO10) (NSRH(I),I=1,24),(XSRH1(I),I=1,6)
      IF (NSRH(2).EQ.3) GO TO 103
      IF (NSRH(10).NE.(-1)) GO TO 107
      READ(KO3) (NXTR1(I),I=1,5),(XTR1(I),I=1,5)
      WRITE(KO10) (NXTR1(I),I=1,5),(XTR1(I),I=1,5)
      NXZ = NXTR1(1)
      READ(KO3) (NXTR1(I),I=1,NXZ)
      WRITE(KO10) (NXTR1(I),I=1,NXZ)
      DO 102 M=1,NXZ
      READ(KO3) (XTR1(I),I=1,I1)
      WRITE(KO10) (XTR1(I),I=1,I1)
  102 CONTINUE
      GO TO 107
  103 CONTINUE
      READ(KO3) (NXTR1(I),I=1,7),(XTR1(I),I=1,5)
      WRITE(KO10) (NXTR1(I),I=1,7),(XTR1(I),I=1,5)
      NXJ = NXTR1(1)
      NXI = NXTR1(2)
      NXKB = NXTR1(3)
      IF (NXJ.LE.0) GO TO 104
      READ(KO3) (XTR1(I),I=1,NXJ)
      WRITE(KO10) (XTR1(I),I=1,NXJ)
  104 IF (NXI.LE.0) GO TO 105
      READ(KO3) (XTR1(I),I=1,NXI)
      WRITE(KO10) (XTR1(I),I=1,NXI)
  105 IF (NXKB.LE.0) GO TO 106
      READ(KO3) (XTR1(I),I=1,NXKB)
      WRITE(KO10) (XTR1(I),I=1,NXKB)
  106 CONTINUE
  107 CONTINUE
      GO TO 100
  108 IF (NREC.EQ.0) GO TO 110
      DO 109 N = 1,NREC
      READ(KO3)I1,I2,J1,T1,J2,T2,J3,T3,J4,T4,J5,T5
      WRITE(KO10)I1,I2,J1,T1,J2,T2,J3,T3,J4,T4,J5,T5
  109 CONTINUE
  110 READ(KO3) INSEC,NREC,KAAX,I1,I2
      WRITE(KO10) INSEC,NREC,KAAX,I1,I2
      IF (NREC.EQ.0) GO TO 112
      DO 111 N = 1,NREC
      READ(KO3)(XTR1(K),K=1,KAAX)
      WRITE(KO10)(XTR1(K),K=1,KAAX)
  111 CONTINUE
  112 READ(KO3)INSEC,NREC,NN,NAAX,MAAX
      WRITE(KO10)INSEC,NREC,NN,NAAX,MAAX
      IF (NREC.EQ.0) GO TO 100
      IF (NN.EQ.0) GO TO 113
      READ(KO3)(NXTR1(N),N=1,NN)
  113 CONTINUE
      READ(KO3)((CONC(N,M),N=1,NAAX),M=1,MAAX)
      IF (NN.EQ.0) GO TO 114
      WRITE(KO10)(NXTR1(N),N=1,NN)
  114 CONTINUE
      WRITE(KO10)((CONC(N,M),N=1,NAAX),M=1,MAAX)
      GO TO 112
  115 CONTINUE
      READ (KO3 )(((HOX(NV,NS,I20),NV=1,NSET),NS=1,I1),I20=1,20)
      READ (KO3 )((NFO(I20,NS),I20=1,20),NS=1,I1)
      READ (KO3 )((NNFO(I20,NS),I20=1,20),NS=1,I1)
      READ(KO3)NIC
      WRITE(KO10)(((HOX(NV,NS,I20),NV=1,NSET),NS=1,I1),I20=1,20)
      WRITE(KO10)((NFO(I20,NS),I20=1,20),NS=1,I1)
      WRITE(KO10)((NNFO(I20,NS),I20=1,20),NS=1,I1)
      WRITE(KO10)NIC
      GO TO 100
  116 READ(KO3) (NXTR1(I),I=1,24)
      WRITE(KO10) (NXTR1(I),I=1,24)
      READ(KO3) (NXTR1(I),I=1,24)
      WRITE(KO10) (NXTR1(I),I=1,24)
      DO 117 II=1,NSET
      READ(KO3) J1,J2,J3,(NXTR1(I),I=1,J2)
      WRITE(KO10) J1,J2,J3,(NXTR1(I),I=1,J2)
  117 CONTINUE
      GO TO 100
  118 CONTINUE
      INSEC = -9999
      NREC = -9999
      WRITE(KO10)INSEC,NREC,NREC,NREC,NREC
      RETURN
      END
