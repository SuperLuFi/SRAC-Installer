C             RELAXT              LEVEL=9        DATE=85.08.27
C     ELEMENT   RELAX
      SUBROUTINE RELAXT(ITCNT,RNEW,OVER,RENORM)
      COMMON /TUD1C/ DUMMY(6),IG,IBOUND,
     &               IGUESS,ID,ITMAX,ITMOUT,ITBGA,LCMX,ITDM,IPT,
     &               EPS,EPS0,EPSG,RELCA,OVERX,FACTOR,XLAMD,BSQ1,
     &               IPTXEC,ITFLUX,IPTS,IDOPT,NXR,
     &               LCIK,LCNK,LCXR,LCRK,LCNN1,LCVOLR,LCNMP,II(500)
C
      COMMON /MAINC/ DUM3(63),NOUT1,NOUT2,DUM4(935)
      DIMENSION RBS(20)
      IF(ITCNT.GT.0) GO TO 2900
 100  LCNT=0
      RELC=RELCA
      ITBG=ITBGA
      ROLD=1.0
      IF(IPT.GT.0) WRITE(NOUT1,70)
      GO TO 3100
   70 FORMAT('   IT    RENORM    RMS RES      RATIO    OVER ' )
 2900 RATIO=RNEW/ROLD
      ROLD=RNEW
      IF (IPT.GT.0)
     &             WRITE(NOUT1,2920) ITCNT,RENORM,RNEW,RATIO,OVER
 2920 FORMAT(I6,F10.5,E13.4,F9.4,F9.4)
 2990 IF (ITCNT.LT.ITBG) GO TO 3100
 3000 LCNT=LCNT+1
      RBS(LCNT)=1./(1.-RATIO)
      IF(LCNT.EQ.1) GO TO 3100
 5000 IF(RBS(LCNT).LT.0. .AND. RBS(LCNT-1).LT.0.) GO TO 3200
      IF (LCNT.LT.LCMX) GO TO 3100
 3020 LCMXP=LCMX
      DO3040M=1,LCMXP
      IF(ABS((RBS(M)-RBS(LCMXP))/RBS(LCMXP)) .GT. EPSG ) GO TO 3050
 3040 CONTINUE
      GO TO 3060
 3050 LCNT=0
      GO TO 3100
 3060 OVER=FACTOR*RBS(LCMXP)
      IF (OVER.LE.OVERX) GO TO 3080
 3070 OVER=OVERX
 3080 ALAM=(RATIO+RELC-1.)/RELC
      RELCB=2./(2.-ALAM)
      IF (RELCB.GE.2.) GO TO 3083
 3082 RELC=RELCB
 3083 WRITE (NOUT2,3085) ITCNT,OVER,RATIO,ALAM,RELC
 3085 FORMAT('0EXTRAPOLATION AT',I4,'  BY,',F9.4/'   MU=',F8.5,
     &'   LAM=',F9.5,'   OMEGA=',F8.5)
      ITBG=ITCNT+ITDM+1
      LCNT=0
      GO TO 3110
 3100 OVER=RELC
 3110 RETURN
 3200 RELC=SQRT(RELC*FACTOR)
      WRITE(NOUT2,50) ITCNT,RATIO,RELC
   50 FORMAT('0 OVER RELAXATION FACTOR MODERATED AT',I4/'   MU=',F8.5,
     &       '   OMEGA=',F8.5)
      GO TO 3050
C     DEBUG SUBCHK
      END
