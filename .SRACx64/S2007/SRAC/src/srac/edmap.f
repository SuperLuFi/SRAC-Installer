C             EDMAP               LEVEL=1        DATE=81.11.14
      SUBROUTINE EDMAP ( XRAD,YRAD,IDUM,IDCS,IHX,IHY,IM,IP,JM,JP,IMJM,
     &IBL,IBT,IBR,IBB,IGEOM,NN )
C
C     MATERIAL MAP BY BROAD ZONES
C
      COMMON /TW1C/ DD(1),LIM1,IAA(210)
      DIMENSION D(212)
      EQUIVALENCE (D(1),DD(1))
      EQUIVALENCE (D(157),NOUT)
C
      DIMENSION XRAD(IP),YRAD(JP),IDUM(IP),IDCS(IMJM),IHX(IM),IHY(JM)
      DIMENSION IWR(3), IFBND(5), NXYZ01(3), NXYZ02(3)
C
CSASA REAL*8 NXYZ01,NXYZ02
      CHARACTER*8 NXYZ01,NXYZ02
CADD SASA
      CHARACTER*4 IWR,ISTR,IFBND
      CHARACTER*4 JBT,JTP,JLF,JRT
C
CCC   DATA IWR,ISTR/1H0,1H1,1H ,1H*/
CCC   DATA IFBND/1H0,1H1,1H2,1H3,1H4/
      DATA IWR,ISTR/'0','1',' ','*'/
      DATA IFBND/'0','1','2','3','4'/
      DATA NXYZ01/'Y     ','Z     ','T     '/
      DATA NXYZ02/'X     ','R     ','R     '/
C
      IS=1
      IE=MIN0(18,IM)
      JBT=IFBND(IBB+1)
      JTP=IFBND(IBT+1)
      JLF=IFBND(IBL+1)
      JRT=IFBND(IBR+1)
      IA=0
  100 IF (IE.LT.IM) JRT=IWR(3)
      IMM=IE-IS
      IMP=6*(IMM+1)
      IMPM=IMP-1
      WRITE (NOUT,210)NXYZ01(IGEOM),NN
      IF (IS.EQ.1) GO TO 110
      WRITE (NOUT,240)
  110 CONTINUE
      WRITE (NOUT,190)YRAD(JP),JLF,(JTP,I=1,IMP)
      DO 140 J=1,JM
      MJ=JP-J
      NXS=(MJ-1)*IM+IA
      NXE=NXS+IE-IA-1
      NXS=NXS+1
      IF (IMM.GT.0) GO TO 120
      WRITE (NOUT,200)JLF,JRT
      WRITE (NOUT,180)MJ,IHY(MJ),JLF,IDCS(NXE+1),JRT
      WRITE (NOUT,200)JLF,JRT
      GO TO 130
  120 WRITE (NOUT,200)JLF,(ISTR,I=1,IMM),JRT
      WRITE (NOUT,180) MJ,IHY(MJ),JLF,(IDCS(I),ISTR,I=NXS,NXE),
     &IDCS(NXE+1),JRT
      WRITE (NOUT,200)JLF,(ISTR,I=1,IMM),JRT
  130 IF (J.EQ.JM) GO TO 140
      WRITE (NOUT,190)YRAD(MJ),JLF,(ISTR,I=1,IMPM),JRT
  140 CONTINUE
      WRITE (NOUT,190)YRAD(1),JLF,(JBT,I=1,IMP)
      K=IE+1
      DO 150 I=IS,K
      IDUM(I)=INT(XRAD(I))
  150 CONTINUE
      WRITE (NOUT,250)NXYZ02(IGEOM),(IDUM(I),I=IS,K)
      DO 160 I=IS,K
      IDUM(I)=IDUM(I)*10000
      IDUM(I)=XRAD(I)*1.0E+4-IDUM(I)
  160 CONTINUE
      WRITE (NOUT,260)(IDUM(I),I=IS,K)
      WRITE (NOUT,220)(IHX(I),I=IS,IE)
      WRITE (NOUT,230)(I,I=IS,IE)
      IF (IE.EQ.IM) GO TO 170
      IA=IE
      IS=IE+1
      IE=MIN0(IE+18,IM)
      JRT=IWR(IBR+1)
      JLF=IWR(3)
      GO TO 100
  170 RETURN
C
C
  180 FORMAT (4X,I3,2X,I2,2X,A1,20(I4,1X,A1))
  190 FORMAT (1H ,F10.4,2X,A1,20(6A1))
  200 FORMAT (13X,A1,20(5X,A1))
  210 FORMAT (1H1,7X,A1,33X,'EDIT NUMBER ',I3,' EDIT SPECIFICATIONS',
     &'Y BROAD ZONE. ORIGIN AT LOWER LEFT.'/'    ROW',3X,'M',31X,
     &'M IS NUMBER OF FINE INTERVALS/BROAD ROW(COLUMN).')
  220 FORMAT (1H0,6X,'M',6X,20(I3,3X))
  230 FORMAT ('    COLUMN',4X,20(I3,3X))
  240 FORMAT (1H+,92X,'(CONTINUED)')
  250 FORMAT (7X,A1,1X,19(I5,'.'))
  260 FORMAT (9X,21(2X,I4))
      END
