CHXRD --109 ***CITATION*** LINE RELAX COLS FOR 1,2-D HEX/ CF-FLUX
C
      SUBROUTINE HXRD( SCAT, P2,DCONB,DCONR,PTSA, IVX,JVX,KVX, IVXP1,
     & JVXP1,IVZ,KVZ,BET,DEL,NRGN,E1,LVX, IOVX,IOVZ)
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      REAL*8 P2
      REAL*8 BET(MSX),DEL(MSX),T,TEMP,TMF,TEMPW
      REAL*8 SCAT
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/AFLUX/BFLUX(30),KXMN8,NIT,NIIT,NIIIT,JXP1,KSCT1,KSCT2,
     & ISTART,IEP, VRGP1,VRGP2,VRGP3,VRG1,VRG2,VRGK1,VRGK2,XABS,PROD,
     & XLEK,RMX,RMN,XKEF1,XKEF2,XKEF3,EXFC1,EXFC2,EXFC3, NI3,IEXTR,
     & IRECV,VRGABS,LO3,LO4,XLAMDA,EPI1,EPI2, BETTA,SUMXI,IX25,IX28,I,J,
     &  KB,K,ITMAX,ITIME, BAT(MSX),DAL(MSX)
C
      DIMENSION SCAT(JVX,IVX), P2(JVX,IVX,KVX),DCONB(JVX,IVXP1,IOVX),
     & DCONR(JVXP1,IVZ,IOVZ),PTSA(JVX,IVX,IOVX)
      DIMENSION NRGN(JVX,IVX),E1(LVX,KVX)
C
      N = IX(20)
CKSK 
      IF (P2(1,1,K).NE.0.0) THEN
CBUG    TEMPW = 1/(PTSA(1,1,N)+E1(1,K))
        L = NRGN(1,1)
        TEMPW = 1/(PTSA(1,1,N)+E1(L,K))
      ENDIF
CKSK      
      KKK = N+IOVX
      IVY=IVX-1
  100 DO 141 J = 1,JVX
      JP1 = J-1
      JP2 = J+1
      DEL(1) = 0.0
      D1 = DCONR(J,1,N)
      D2 = DCONR(JP2,1,N)
      D4 = DCONB(J,2,N)
  101 IF (J-1) 102,102,108
  102 IF (P2(1,1,K)) 103,104,103
  103 BET(1) = (P2(2,1,K)*D2+ SCAT(1,1))/D4
CKSK  DEL(1) = D4/(PTSA(1,1,N)+E1(1,K))
      DEL(1) = D4*TEMPW 
  104 DO 107 I = 2,IVX
      IF (P2(1,I,K)) 106,105,106
  105 DEL(I) = 0.0
      GO TO 107
  106 T=D4*DEL(I-1)
      L = NRGN(1,I)
      D4 = DCONB(1,I+1,N)
      BET(I) = (P2(2,I,K)*DCONR(2,I,N)+ SCAT(1,I)+ P2(2,I-1,K)*DCONR(2,
     & I,KKK)+BET(I-1)*T)/D4
      DEL(I) = D4/(PTSA(1,I,N)-T+E1(L,K))
  107 CONTINUE
      GO TO 125
  108 IF (J-JVX) 117,109,109
  109 IF (P2(JVX,1,K)) 110,111,110
  110 BET(1) = (P2(JP1,1,K)*D1+P2(JP1,2,K)*DCONR(JVX,2,KKK)+ SCAT(J,1))/
     &  D4
      L = NRGN(JVX,1)
      DEL(1) = D4/(PTSA(JVX,1,N)+E1(L,K))
  111 DO 114I=2,IVY
      IF (P2(JVX,I,K)) 113,112,113
  112 DEL(I) = 0.0
      GO TO 114
  113 T=D4*DEL(I-1)
      L = NRGN(JVX,I)
      D4 = DCONB(J,I+1,N)
      BET(I) = (P2(JP1,I,K)*DCONR(JVX,I,N)+ P2(JP1,I+1,K)*DCONR(JVX,I+1,
     &  KKK)+SCAT(JVX,I)+BET(I-1)*T)/D4
      DEL(I) = D4/(PTSA(JVX,I,N)-T+E1(L,K))
  114 CONTINUE
      IF (P2(JVX,IVX,K)) 116,115,116
  115 DEL(IVX)=0.
      GO TO 125
  116 T=D4*DEL(I-1)
      L = NRGN(JVX,IVX)
      D4=DCONB(J,IVXP1,N)
      BET(IVX)=(P2(JP1,IVX,K)*DCONR(JVX,IVX,N)+SCAT(JVX,IVX)+BET(IVX-1)*
     &  T)/D4
      DEL(IVX)=D4/(PTSA(JVX,IVX,N)-T+E1(L,K))
      GO TO 125
  117 IF (P2(J,1,K)) 118,119,118
  118 CONTINUE
      L = NRGN(J,1)
      BET(1) = (P2(JP1,1,K)*D1+P2(JP2,1,K)*D2+ P2(JP1,2,K)*DCONR(J ,2,
     & KKK)+SCAT(J,1))/D4
      DEL(1) = D4/(PTSA(J ,1,N)+E1(L,K))
  119 CONTINUE
      DO 122I=2,IVY
      IF (P2(J,I,K)) 121,120,121
  120 DEL(I) = 0.0
      GO TO 122
  121 T=D4*DEL(I-1)
      L = NRGN(J,I)
      D4 = DCONB(J,I+1,N)
      BET(I) = (P2(JP1,I,K)*DCONR(J,I,N)+P2(JP2,I,K)*DCONR(JP2,I,N)+
     & P2(JP1,I+1,K)*DCONR(J,I+1,KKK)+P2(JP2,I-1,K)*DCONR(JP2,I,KKK)+
     & SCAT(J,I)+BET(I-1)*T)/D4
      DEL(I) = D4/(PTSA(J,I,N)-T+E1(L,K))
  122 CONTINUE
      IF (P2(J,IVX,K)) 124,123,124
  123 DEL(IVX)=0.
      GO TO 125
  124 T=D4*DEL(I-1)
      L = NRGN(J,IVX)
      D4=DCONB(J,IVXP1,N)
      BET(IVX)=(P2(JP1,IVX,K)*DCONR(J,IVX,N)+P2(JP2,IVX,K)*DCONR(JP2,
     & IVX,N)+P2(JP2,IVX-1,K)*DCONR(JP2,IVX,KKK)+SCAT(J,IVX)+BET(IVX-1)*
     &  T)/D4
      DEL(IVX)=D4/(PTSA(J,IVX,N)-T+E1(L,K))
  125 TEMP = BET(IVX)*DEL(IVX)
      T = P2(J,IVX,K)
      TMF=T+VRGK2*(TEMP-T)
      IF (IEP) 126,130,127
  126 P2(J,IVX,K)=TEMP
      GO TO 131
  127 IF (TMF-TEMP) 129,130,128
  128 TMF = DMIN1(TMF,(TEMP+ T))
      GO TO 130
  129 TMF = DMAX1(TMF,0.5*TEMP)
  130 CONTINUE
      P2(J,IVX,K)=TMF
  131 DO 138 JJ = 2,IVX
      I=IVXP1-JJ
      T = P2(J,I,K)
      TEMP = DEL(I)*(TEMP+BET(I))
      TMF=T+VRGK2*(TEMP-T)
      IF (IEP) 132,136,133
  132 P2(J,I,K)=TEMP
      GO TO 138
  133 IF (TMF-TEMP) 135,136,134
  134 TMF = DMIN1(TMF,(TEMP+ T))
      GO TO 136
  135 TMF = DMAX1(TMF,0.5*TEMP)
  136 CONTINUE
  137 P2 (J,I, K) = TMF
  138 CONTINUE
      IF (NUAC(8)) 139,141,141
  139 M=JVXP1-J
      DO 140I=1,IVX
      L=IVXP1-I
      P2(M,L,K)=P2(J,I,K)
  140 CONTINUE
  141 CONTINUE
      RETURN
      END
