CKMOT --033 ***CITATION*** PRINTS MAP FOR 3-D/ CF-KOMP,IPTM
C
      SUBROUTINE KMOT(ISTEP,NRGNE,NCOMP, IVX,JVX,KBVX,LVX)
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
C
      COMMON /CRBNC/ ICONV,ICRBN,NCBSTP,AVZAB(ZNEX)
C     ICRBN IS SET IN CIT1 IF SRAC, OR CRBN IF COREBN
C     ICRBN =0 : SRAC-CITATION, ICRBN=1 : COREBN
C     NCBSTP   : BURNUP STEP IN COREBN
C
      DIMENSION NRGNE(JVX,IVX,KBVX)
      DIMENSION NCOMP(LVX)
C
CKSK
      IF(ICRBN.EQ.0) THEN
        IPRNT = ISTEP
        IF (ISTEP.EQ.1.AND.IEDG(24).NE.0) IPRNT = 0
      ELSE
        IPRNT = NCBSTP
      ENDIF
CKSK
  100 IS1 = 0
      IF(IPRNT.EQ.1)WRITE(IOUT,1000)
      DO 110 KB = 1,KBMAX
      IF(IPRNT.EQ.1)WRITE(IOUT,1001)KB
      N1J = JMAX
      N2J = 0
  101 IF (N1J-40) 102,102,103
  102 N1L = N2J+1
      N2J = JMAX
      IS1 = 1
      GO TO 104
  103 N1L = N2J+1
      N2J = N2J+40
      N1J = N1J-40
  104 CONTINUE
  105 IF(IPRNT.EQ.1)WRITE(IOUT,1002)(J,J=N1L,N2J)
      IF(IPRNT.EQ.1)WRITE(IOUT,1003)
      DO 107 I = 1,IMAX
      DO 106 J = N1L,N2J
      L = NRGNE(J,I,KB)
      NXTR1(J) = NCOMP(L)
  106 CONTINUE
      IF(IPRNT.EQ.1)WRITE(IOUT,1004)I,(NXTR1(J),J= N1L,N2J)
  107 CONTINUE
      IF (IS1) 108,108,109
  108 IF(IPRNT.EQ.1)WRITE(IOUT,1000)
      GO TO 101
  109 IS1 = 0
  110 CONTINUE
      RETURN
 1000 FORMAT(1H0,'ZONE NUMBER AT EACH MESH INTERVAL')
 1001 FORMAT(1H0/1H0,'SPECIFICATION FOR LAYER NUMBER',I3)
 1002 FORMAT(1H0,I8,39I3)
 1003 FORMAT(1H )
 1004 FORMAT(1H ,I3,I5,39I3)
      END
