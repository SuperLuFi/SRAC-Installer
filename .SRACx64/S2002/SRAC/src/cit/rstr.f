CRSTR --059-***CITATION***-READS-RESTART-TAPE/CF-IPTM
C
      SUBROUTINE RSTR(NTITE,A,MEMORY)
C
C     NTITE SET TO 0 IFRESTARTSTATICSONLY.
C                  1IFRESTARTATENDOFSOMECYCLE
C                    ORCONTINUEACYCLE.GT.1.
C                 -1IFRESTARTDEPLETIONONLYPROBLEM
C                    ORCONTINUEFIRSTCYCLE.
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/AMESH/BMESH(30),NREGI,NREGJ,NREGKB,XSHI(RGX),XSHJ(RGX),
     & XSHKB(RGX), MSHI(RGX),MSHJ(RGX),MSHKB(RGX),Y(MSX),YY(MSX), X(MSX)
     &  ,XX(MSX),Z(MSX),ZZ(MSX), ZONVOL(ZNEX),AVZPD(ZNEX),PDI(MSX),
     & PDJ(MSX) , PDK(MSX)
      COMMON/AFLUX/BFLUX(30),KXMN8,NIT,NIIT,NIIIT,JXP1,KSCT1,KSCT2,
     & ISTART,IEP, VRGP1,VRGP2,VRGP3,VRG1,VRG2,VRGK1,VRGK2,XABS,PROD,
     & XLEK,RMX,RMN,XKEF1,XKEF2,XKEF3,EXFC1,EXFC2,EXFC3, NI3,IEXTR,
     & IRECV,VRGABS,LO3,LO4,XLAMDA,EPI1,EPI2, BETTA,SUMXI,IX25,IX28,I,J,
     &  KB,K,ITMAX,ITIME, BET(MSX),DEL(MSX)
      COMMON/ABURN/BBURN(30),NSIG1(50),NSIG2(50),NSIG3(50),N1N2R(2,ZDX),
     &  NSIG4(50),NSIG5(50),NSIG6(50),NJM(50),NJMM(50),NJNQ(50),NCH(50),
     &  NZON(ZDX),NXSET(ZDX),NXODR(ZDX),IDXSET(ZDX),NCLASS(ZDX),NDP(ZDX)
     &  , XNAME(3,ZDX)
      COMMON/AVDLM/IVDLM(1),IVX,JVX,KBVX,KVX,LVX,MVX,NVX,IVXP1,JVXP1,
     & KBVXP1,NSETVX,NVO,IVO,IVZ,KVZ,NCRP,NSPA,N3DDIM,NBLOCK,NUO, JIVX,
     & JIP1VX,JP1IXZ,IOVX,IOVZ
      COMMON/AKADD/KAY(1),K1,K2,K3,K4,K5,K6,K7,K8,K9,K10,K11, K12,K13,
     & K131,K14,K15,K16,K17,K18,K19,K20,K21,K22,K23,K24, K25,K26,K27,
     & K28,K29,K30,K31,K32,K33,K34,K35,K36,K37, K38,K39,K40,K41,K42,K43,
     &  K44,K45,K46,K47,K48,K49, K50,K51,K52,K53,K54,K55,K56,K57,K58,
     & K59, K60,K61,K62, K63,K64,K65,K66,K67,K68,K69,K70,K71,K72,K73,
     & K74,K75, K76,K77,K78,K79,K80,K81,K82,K83,K84,K85,K86,K87, K88,
     & K89,K90, K91,K92,K93,K94,K95,K96,K97,K98, K99,K100,NDATA,KNRGN,
     & KNCOMP, KPVOL,KRVOL,MEMVRY, MEMX
      COMMON/ASRCH/ BSRCH(30),XK1,XK2,XK3,XN1,XN2,XN3, DELK1,DELK2,
     & DELK3,BATTY,DRV,TBF,GWC,EK2,RCCM,DNDK(5), NSC(5),NSCN,NXZ,NXN,
     & NXM,NXS,INIL,INIU,INID
C
      DIMENSION A(MEMORY)
C
  100 REWIND IO1
      WRITE(IO1)(TITL1(I),I=1,18),(TITL2(I),I=1,18),(NGC(I),I=1,24),
     & (IEDG(I),I=1,24),(ITMX(I),I=1,24),(GLIM(I),I=1,6), IX(5),
     & SPARE(50)
      END FILE IO1
      REWIND IO1
      REWIND IO2
      ISHRW = 0
      IO10 = IX(77)
      IO12 = IX(79)
      REWIND IO12
      IO13 = IX(80)
      IOR = IO13
      REWIND IOR
      NGC2 = NGC(2)
      MEMTRY = 0
      READ(IOR)II
      IF (II.EQ.999) GO TO 102
  101 WRITE(IOUT,1000)II,NGC2,MEMTRY,MEMORY
      WRITE(IOUT,2000)
      STOP
  102 CONTINUE
      READ(IOR)N1,N2,N3,N4,N5,N6,N7,N8,N9,N10,N13,N14,MEMTRY
      READ(IOR)(TITL1(I),I=1,18),(TITL2(I),I=1,18)
      WRITE(IOUT,1001)(TITL1(I),I=1,18)
      WRITE(IOUT,1002)(TITL2(I),I=1,18)
      IF (MEMTRY.NE.MEMORY) GO TO 101
      READ(IOR)(BLSUB(I1),I1=1,N1)
      READ(IOR)(BMESH(I1),I1=1,N2)
      READ(IOR)(BFLUX(I1),I1=1,N3)
      READ(IOR)(BBURN(I1),I1=1,N4)
      READ(IOR)(IVDLM(I1),I1=1,N5)
      READ(IOR)(KAY(I1),I1=1,N7)
      READ(IOR)(BSRCH(I1),I1=1,N13)
      READ(IOR)(A(I1),I1=K8 ,N8)
      READ(IOR)(A(I1),I1=K50 ,N9)
      READ(IOR)(A(I1),I1=KNRGN ,N10)
      READ(IOR)(A(I1),I1=KNCOMP,MEMORY)
      READ(IOR)(A(I1),I1=K45,N14)
      REWIND IO10
      IREAD = IOR
      IRITE = IO10
      CALL TRAN(A(K17),MVX,NVX,IREAD,IRITE, A(K30),A(K31),A(K32),A(K33),
     &  NSETVX)
      END FILE IO10
      REWIND IO10
      IO19 = IX(86)
      REWIND IO19
      NL = K42-1
      WRITE(IO19)(A(I),I=K30,NL)
      END FILE IO19
      REWIND IO19
      IO26 = IX(93)
      REWIND IO26
      READ(IOR)II
      IF (II.NE.0) GO TO 101
      READ(IOR)N12,NKM,(IX(I),I=1,200),(SPARE(I),I=1,200), (A(I),I=K14,
     & N12)
      WRITE(IO2)(A(I),I=K17,N12)
      READ(IOR)N11,N22,(BFLUX(I1),I1=1,N22),SPARE(39), (A(I),I=K24,N11)
      WRITE(IO26) N11,(A(I),I=K24,N11)
      END FILE IO2
      REWIND IO2
      END FILE IO26
      REWIND IO26
      IF (NGC(1).GT.0) GO TO 103
      REWIND IOR
      NTITE = 0
      IX19 = 1
      GO TO 104
  103 CONTINUE
      IX19 = NGC2
      NTITE = 1
      READ(IOR)II
      BACKSPACE IOR
      IF ((NGC2.GT.0).OR.(II.EQ.-11111)) IX(2) = 0
      IF ((NGC2.GT.0).OR.(II.GT.0).OR.(II.EQ.-11111)) GO TO 106
      IF ((NGC2.GT.0).AND.(II.LT.0)) GO TO 101
      NTITE = -1
      IX19 = II
      IF (NDPL(11).GT.0) CALL RODO(A(KNCOMP),LVX)
      READ(IOR)II
      READ(IOR)N12,NKM,(IX(I),I=1,200),(SPARE(I),I=1,200), (A(I),I=K14,
     & N12),(A(I),I=KNCOMP,NKM)
      BACKSPACE IOR
      BACKSPACE IOR
  104 CONTINUE
      IF (NGC(19).GT.0) GO TO 106
      IF (NGC(1).EQ.0) READ(IO2)(A(I),I=K17,N12)
      NZN2 = 0
      WRITE(IO12)MMAX,MMAX,MMAX,MMAX,MMAX
      DO 105 M = 1,MMAX
      NACT = NXSET(M)
      MS1 = NXODR(NACT)
      NZN1 = NZN2+1
      NZN2 = NZN2+NJM(MS1)*NZON(M)
      J1 = NZN1+K18-1
      J2 = NZN2+K18-1
      WRITE(IO12)NZN1,NZN2
      WRITE(IO12)(A(I),I=J1,J2)
  105 CONTINUE
      END FILE IO12
      REWIND IO12
      REWIND IO2
  106 CONTINUE
      READ(IO19)(A(I),I=K30,NL)
      REWIND IO19
      READ(IO1)(TITL1(I),I=1,18),(TITL2(I),I=1,18),(NGC(I),I=1,24),
     & (IEDG(I),I=1,24),(ITMX(I),I=1,24),(GLIM(I),I=1,6), IX(5),
     & SPARE(50)
      REWIND IO1
      IX(19) = IX19
      IX(22) = 0
      IX(39) = 0
      IX(198) = NTITE
      RETURN
 1000 FORMAT(1H0,'ERROR STOP 27 IN SUB. RSTR',10X,10I8)
 1001 FORMAT(1H0,'THE CASE TITLE ON THE RESTART TAPE IS'/1H0,18A4)
 1002 FORMAT(1H ,18A4)
 1003 FORMAT(1H0,'MYERROR',10I5)
 2000 FORMAT(' THE RESTART DEVICE, LOGICAL 13, DOES NOT CONTAIN PROPER',
     &       ' DATA')
      END
