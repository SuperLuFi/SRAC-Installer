CHWRD --108 ***CITATION*** LINE RELAX ROWS FOR 1,2-D HEX/ CF-FLUX
C
      SUBROUTINE HWRD( SCAT, P2,DCONB,DCONR,PTSA, IVX,JVX,KVX, IVXP1,
     & JVXP1,IVZ,KVZ,BET,DEL,NRGN,E1,LVX, IOVX,IOVZ)
C
CDEL  INTEGER RGX , MSX , ZNEX , ZDX , WZX
CDEL  PARAMETER ( RGX=100, MSX=211, ZDX=200, ZNEX=1000, WZX=100 )
      INCLUDE  'CITPMINC'
C
      REAL*8 P2
      REAL*8 BET(MSX),DEL(MSX),T,TEMP,TMF,TEMPW
      REAL*8 SCAT
C
      COMMON/ALSUB/BLSUB(30),TITL1(18),TITL2(18),IMAX,JMAX,KBMAX,KMAX,
     & LMAX,MMAX, NMAX,IMXP1,JMXP1,KBMXP1,NSETMX,NTO,MM1VX,KM1VX,IOIN,
     & IOUT,IOSIG,IOFLX,IO1,IO2,IO3,IO4,IO7,NER(100), IX(200),INNO(100),
     &  NGC(24),IEDG(24),ITMX(24),TIMX(6), GLIM(6),NDPL(24),IEDP1(24),
     & IEDP2(24),IEDP3(24), DPLH(6),NUAC(24),EPI(6),XMIS(6),NSRH(24),
     & XSRH1(6), XTR1(WZX),XTR2(WZX),NXTR1(WZX),NXTR2(WZX),SPARE(200),
     & IXPUT(200),XPUT(200)
      COMMON/AFLUX/BFLUX(30),KXMN8,NIT,NIIT,NIIIT,JXP1,KSCT1,KSCT2,
     & ISTART,IEP, VRGP1,VRGP2,VRGP3,VRG1,VRG2,VRGK1,VRGK2,XABS,PROD,
     & XLEK,RMX,RMN,XKEF1,XKEF2,XKEF3,EXFC1,EXFC2,EXFC3, NI3,IEXTR,
     & IRECV,VRGABS,LO3,LO4,XLAMDA,EPI1,EPI2, BETTA,SUMXI,IX25,IX28,I,J,
     &  KB,K,ITMAX,ITIME, BAT(MSX),DAL(MSX)
C
      DIMENSION SCAT(JVX,IVX), P2(JVX,IVX,KVX),DCONB(JVX,IVXP1,IOVX),
     & DCONR(JVXP1,IVZ,IOVZ),PTSA(JVX,IVX,IOVX)
      DIMENSION NRGN(JVX,IVX),E1(LVX,KVX)
C
      N = IX(20)
CKSK
      IF (P2(1,1,K).NE.0.0) THEN
CBUG    TEMPW = 1/(PTSA(1,1,N)+E1(1,K))
        L = NRGN(1,1)
        TEMPW = 1/(PTSA(1,1,N)+E1(L,K))
      ENDIF
CKSK          
  100 JVY=JVX-1
      KKK = N+IOVX
      DO 144 I = 1,IVX
      IP1 = I-1
      IP2 = I+1
      DEL(1) = 0.0
      D1 = DCONB(1,I,N)
      D2 = DCONB(1,IP2,N)
      D4 = DCONR(2,I,N)
  101 IF (I-1) 102,102,108
  102 IF (P2(1,1,K)) 103,104,103
  103 BET(1) = (P2(1,2,K)*D2+ SCAT(1,1))/D4
CKSK  DEL(1) = D4/(PTSA(1,1,N)+E1(1,K))
      DEL(1) = D4*TEMPW 
  104 DO 107 J = 2,JVX
      IF (P2(J,1,K)) 106,105,106
  105 DEL(J) = 0.0
      GO TO 107
  106 T=D4*DEL(J-1)
      L = NRGN(J,1)
      D4 = DCONR(J+1,1,N)
      BET(J) = (P2(J,2,K)*DCONB(J,2,N)+ SCAT(J,1)+ P2(J-1,2,K)*DCONR(J,
     & 2,KKK)+BET(J-1)*T)/D4
      DEL(J) = D4/(PTSA(J,1,N)-T+E1(L,K))
  107 CONTINUE
      GO TO 125
  108 IF (I-IVX) 117,109,109
  109 IF (P2(1,IVX,K)) 110,111,110
  110 BET(1) = (P2(1,IP1,K)*D1+P2(2 ,IP1,K)*DCONR(2 ,IVX,KKK)+ SCAT(1,
     & IVX))/D4
      L = NRGN(1,IVX)
      DEL(1) = D4/(PTSA(1,IVX,N)+E1(L,K))
  111 DO 114J=2,JVY
      IF (P2(J,IVX,K)) 113,112,113
  112 DEL(J) = 0.0
      GO TO 114
  113 T=D4*DEL(J-1)
      L = NRGN(J,IVX)
      D4 = DCONR(J+1,IVX,N)
      BET(J) = (P2(J,IP1,K)*DCONB(J,IVX,N)+ P2(J+1,IP1,K)*DCONR(J+1,IVX,
     &  KKK)+SCAT(J,IVX)+BET(J-1)*T)/D4
      DEL(J) = D4/(PTSA(J,IVX,N)-T+E1(L,K))
  114 CONTINUE
      IF (P2(JVX,IVX,K)) 116,115,116
  115 DEL(JVX)=0
      GO TO 125
  116 T=D4*DEL(J-1)
      L = NRGN(JVX,IVX)
      D4=DCONR(JVXP1,IVX,N)
      BET(JVX)=(P2(JVX,IP1,K)*DCONB(JVX,IVX,N)+SCAT(JVX,IVX)+BET(JVX-1)*
     &  T)/D4
      DEL(JVX)=D4/(PTSA(JVX,IVX,N)-T+E1(L,K))
      GO TO 125
  117 IF (P2(1,I,K)) 118,119,118
  118 CONTINUE
      L = NRGN(1,I)
      BET(1) = (P2(1,IP1,K)*D1+P2(1,IP2,K)*D2+ P2(2 ,IP1,K)*DCONR(2 ,I,
     & KKK)+SCAT(1,I))/D4
      DEL(1) = D4/(PTSA(1,I,N)+E1(L,K))
  119 CONTINUE
      DO 122J=2,JVY
      IF (P2(J,I,K)) 121,120,121
  120 DEL(J) = 0.0
      GO TO 122
  121 T=D4*DEL(J-1)
      L = NRGN(J,I)
      D4 = DCONR(J+1,I,N)
      BET(J) = (P2(J,IP1,K)*DCONB(J,I,N)+P2(J,IP2,K)*DCONB(J,IP2,N)+
     & P2(J+1,IP1,K)*DCONR(J+1,I,KKK)+P2(J-1,IP2,K)*DCONR(J,IP2,KKK)+
     & SCAT(J,I)+BET(J-1)*T)/D4
      DEL(J) = D4/(PTSA(J,I,N)-T+E1(L,K))
  122 CONTINUE
      IF (P2(JVX,I,K)) 124,123,124
  123 DEL(JVX)=0.
      GO TO 125
  124 T=D4*DEL(J-1)
      L = NRGN(JVX,I)
      D4=DCONR(JVX+1,I,N)
      BET(JVX)=(P2(JVX,IP1,K)*DCONB(JVX,I,N)+P2(JVX,IP2,K)*DCONB(JVX,
     & IP2,N )+P2(JVX-1,IP2,K)*DCONR(JVX,IP2,KKK)+SCAT(JVX,I)+BET(JVX-1)
     &  *T)/D4
      DEL(JVX)=D4/(PTSA(JVX,I,N)-T+E1(L,K))
  125 CONTINUE
  126 TEMP = BET(JVX)*DEL(JVX)
      T = P2(JVX,I,K)
      TMF = T+BETTA*(TEMP-T)
      IF (IEP) 127,131,128
  127 P2(JVX,I,K)=TEMP
      GO TO 132
  128 IF (TMF-TEMP) 130,131,129
  129 TMF = DMIN1(TMF,(TEMP+ T))
      GO TO 131
  130 TMF = DMAX1(TMF,0.5*TEMP)
  131 CONTINUE
      P2 (JVX,I, K) = TMF
  132 DO 139 JJ = 2,JVX
      J = JVXP1-JJ
      T = P2(J,I,K)
      TEMP = DEL(J)*(TEMP+BET(J))
      TMF = T+BETTA*(TEMP-T)
      IF (IEP) 133,137,134
  133 P2(J,I,K)=TEMP
      GO TO 139
  134 IF (TMF-TEMP) 136,137,135
  135 TMF = DMIN1(TMF,(TEMP+ T))
      GO TO 137
  136 TMF = DMAX1(TMF,0.5*TEMP)
  137 CONTINUE
  138 P2 (J,I, K) = TMF
  139 CONTINUE
      IF (NUAC(8)) 140,144,142
  140 L=IVXP1-I
      DO 141J=1,JVX
      M=JVXP1-J
      P2(M,L,K)=P2(J,I,K)
  141 CONTINUE
      GO TO 144
  142 DO 143J=1,JVX
      P2(I,J,K)=P2(J,I,K)
  143 CONTINUE
  144 CONTINUE
      RETURN
      END
