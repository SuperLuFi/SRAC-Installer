      SUBROUTINE RELAX(ITCNT,RNEW,OVER,RENORM)
C
      COMMON / PIJ2C /
     &                 IDUM(19),ITMINN,ITMOUT,ITBGA,LCMX,ITDM,IPT,
     &                 EPSI,EPSO,EPSG,RELCA,OVERX,FACTOR
      COMMON / MAINC / DUM(63),NOUT1,NOUT2,IT0,DUM1(836)
CDEL  DIMENSION RBS(20)
      DIMENSION RBS(100)
C
      IF(ITCNT.LE.0) THEN
                     LCNT = 0
                     RELC = RELCA
                     ITBG = ITBGA
                     ROLD = 1.0
                     IF(LCMX.GT.20) LCMX = 20
                     IF(IPT.GT.0) WRITE(NOUT1,70)
                     GO TO 3100
                     ENDIF
C
      RATIO = RNEW/ROLD
      ROLD  = RNEW
      IF (IPT.GT.0) WRITE(NOUT1,2920) ITCNT,RENORM,RNEW,RATIO,OVER
C
 2990 IF (ITCNT.LT.ITBG) GO TO 3100
 3000 LCNT     = LCNT + 1
      RBS(LCNT)= 1.00/(1.00-RATIO)
      IF(LCNT.EQ.1)      GO TO 3100
 5000 IF(RBS(LCNT).LT.0.0 .AND. RBS(LCNT-1).LT.0.0) GO TO 3200
      IF (LCNT.LT.LCMX)  GO TO 3100
 3020 LCMXP    = LCMX
      DO 3040 M= 1,LCMXP
      IF(ABS((RBS(M)-RBS(LCMXP))/RBS(LCMXP)) .GT. EPSG ) GO TO 3050
 3040 CONTINUE
      GO TO 3060
C
 3050                    LCNT=0
                         GO TO 3100
C
 3060 OVER  = FACTOR*RBS(LCMXP)
      IF (OVER.LE.OVERX) GO TO 3080
 3070 OVER  = OVERX
 3080 ALAM  = (RATIO+RELC-1.0)/RELC
      RELCB = 2.0/(2.0-ALAM)
      IF (RELCB.GE.2.0) GO TO 3083
 3082 RELC  = RELCB
 3083 WRITE (NOUT2,3085) ITCNT,OVER,RATIO,ALAM,RELC
      ITBG  = ITCNT + ITDM + 1
      LCNT  = 0
      GO TO 3110
C
 3100 OVER  = RELC
 3110 RETURN
C
 3200 RELC  = SQRT(RELC*FACTOR)
      WRITE(NOUT2,50) ITCNT,RATIO,RELC
      GO TO 3050
C
   50 FORMAT(1H0,'OVER RELAXATION FACTOR MODERATED AT',I4/'   MU=',F8.5,
     &       '   OMEGA=',F8.5)
   70 FORMAT('   IT    RENORM    RMS RES      RATIO    OVER ')
 2920 FORMAT(I6,F10.5,E13.4,F9.4,F9.4)
 3085 FORMAT('0EXTRAPOLATION AT',I4,'  BY',F9.4/'   MU=',F8.5,
     &'   LAM=',F8.5,'   OMEGA=',F8.5)
C
      END
