CCXXXXXXXXXXXXXXXX DOUBLE HETEROGENEITY OPTION
      FUNCTION PE(IGEOM,X)
      PE = 0.0
CC
CC    IGEOM=1  SLAB
CC          2  CYLINDER
CC          3  SPHERE
CC
      DATA EULER/0.577216/
CC
      GO TO (100,200,300),IGEOM
CC
  100 IF( X.GT. 0.01 ) GO TO 120
      PE=1. + 0.5*X*(ALOG(X) - 1.5 + EULER - 0.333333*X)
      GO TO 400
CC
  120 IF(X .GT. 6. ) GO TO 140
      PE=(0.5-ENX(3,X))
      GO TO 400
CC
  140 PE=0.5/X
      GO TO 400
CC
  200 IF( X .GT. 0.1 ) GO TO 220
      PE=1.-1.33333*X+ 0.5*X*X*(ALOG(2/X)+1.25-EULER)
      GO TO 400
CC
  220 IF( X .GT. 6. ) GO TO 240
CKSK  XBK0=BK0(X)
CKSK  XBK1=BK1(X)
CKSK  XBI0=BI0(X)
CKSK  XBI1=BI1(X)
      CALL BESLK0(X,XBK0,ICON)
      CALL BESLK1(X,XBK1,ICON)
      CALL BESLI0(X,XBI0,ICON)
      CALL BESLI1(X,XBI1,ICON)
CKSK
      PE=0.666666*X*(2.*(X*XBK1*XBI1+XBK0*XBI0-1.)
     &              + XBK1*XBI1/X  -XBK0*XBI1 + XBK1*XBI0)
      GO TO 400
CC
  240 PE=0.5*(1.-3./16./X/X)/X
      GO TO 400
CC
  300 IF( X .GT. 0.05) GO TO 320
      PE=1.-0.75*X
      GO TO 400
CC
  320 IF( X .GT. 6. ) GO TO 340
      PE=3./8./X/X/X*(2.*X*X-1.+(1.+2.*X)*EXP(-2.*X))
      GO TO 400
CC
  340 PE=0.75/X*(1.-0.5/X/X)
CC
  400 RETURN
      END
